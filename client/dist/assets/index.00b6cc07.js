import{f as e,e as t,l as a,o as s,c as l,F as r,r as n,a as o,t as i,d as c,b as d,g as u,w as h,h as m,i as f,j as p,k as g,s as v,m as y,n as b,p as w,q as x,B as k,u as S,v as M,x as _,y as j,z as B,A as F,C as A,D as P,E as D,G as R,P as z,M as C,I as E,H as I,J as O,K as $,L as H,N as L,O as W,Q as N,R as U,S as V,T,U as Y,V as G,W as X,X as q,Y as K,Z as J,_ as Q,$ as Z,a0 as ee,a1 as te,a2 as ae,a3 as se,a4 as le,a5 as re,a6 as ne,a7 as oe,a8 as ie,a9 as ce,aa as de,ab as ue,ac as he,ad as me,ae as fe,af as pe,ag as ge,ah as ve,ai as ye,aj as be,ak as we,al as xe,am as ke,an as Se,ao as Me,ap as _e,aq as je,ar as Be,as as Fe,at as Ae,au as Pe}from"./vendor.29b90e47.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),l=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,r)=>{const n=new URL(e,s);if(self[t].moduleMap[n])return a(self[t].moduleMap[n]);const o=new Blob([`import * as m from '${n}';`,`${t}.moduleMap['${n}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){r(new Error(`Failed to import: ${e}`)),l(i)},onload(){a(self[t].moduleMap[n]),l(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/assets/");const De={name:"VerticalBarPlot",props:["mydata","width","height","selectedmetric"],data:()=>({textWidth:70,barwidth:25,dataformat:e(".2f")}),computed:{svgheight(){return this.barwidth*this.mydata.length},bardata(){return this.mydata.map((e=>({name:e.name,value:e[this.selectedmetric]}))).sort(((e,t)=>t.value-e.value))},xscale(){const e=t(this.bardata.map((e=>e.value)));return e[0]>.1?e[0]-=.1:e[0]=0,a().domain(e).range([0,this.width-this.textWidth])}}},Re=["width","height"],ze=["x","y","dy"],Ce=["x","y","width","height"],Ee=["x","y","dy"];De.render=function(e,t,a,c,d,u){return s(),l("svg",{width:a.width,height:u.svgheight},[(s(!0),l(r,null,n(u.bardata,((e,t)=>(s(),l("g",{key:e.name},[o("text",{x:d.textWidth-5,y:d.barwidth*t,dy:d.barwidth-7,"text-anchor":"end"},i(e.name),9,ze),o("rect",{x:d.textWidth,y:d.barwidth*t+d.barwidth/4,width:u.xscale(e.value),height:d.barwidth-10,fill:"#a0a0a0"},null,8,Ce),o("text",{x:d.textWidth+u.xscale(e.value)-2,y:d.barwidth*t,dy:d.barwidth-7,"text-anchor":"end",fill:"white"},i(d.dataformat(e.value)),9,Ee)])))),128))],8,Re)};var Ie=c({name:"Axis",props:{orient:String,scale:Function,translateX:Number,translateY:Number,ticks:{type:Number,default:4},type:{type:String,default:"number"},rotatestyle:{type:Boolean,default:!1},format:{type:Function}},computed:{transform(){return"translate("+this.translateX+","+this.translateY+")"}},setup(e){const t=d(null),a={top:m(),right:f(),bottom:p(),left:g()};return u((()=>{h((()=>{(()=>{if("category"===e.type){const s=v(t.value).call(a[e.orient].scale(e.scale)).selectAll("text");e.rotatestyle&&s.style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",(function(e){return"rotate(-35)"}))}else v(t.value).call(a[e.orient].scale(e.scale).ticks(e.ticks).tickFormat(e.format).tickSize(2))})()}))})),{axisRef:t}}});const Oe=["transform"];Ie.render=function(e,t,a,r,n,o){return s(),l("g",{ref:"axisRef",transform:e.transform,class:"axis"},null,8,Oe)},Ie.__scopeId="data-v-0fd1cf29";const $e={name:"ClassBar",components:{Axis:Ie},data:()=>({margin:{top:18,left:23,bottom:18,right:23},yaxisformat:function(t){return e(".2~s")(t)}}),props:["width","height","classfeature","subsetclassfeature","colorscale","colorScaleDark"],computed:{chartWidth(){return this.width-this.margin.left-this.margin.right},chartHeight(){return this.height-this.margin.top-this.margin.bottom},xscale(){return y().domain(this.classfeature.map((e=>e.category))).range([0,this.chartWidth]).padding(.4)},yscale(){return a().domain([0,b(this.classfeature,(e=>e.value))]).rangeRound([this.chartHeight,0])},yscale2(){return a().domain([0,b(this.subsetclassfeature,(e=>e.value))]).rangeRound([this.chartHeight,0])}}},He=["width","height"],Le=["transform"],We=o("text",{x:"0",y:"0",dy:"-8","text-anchor":"middle","font-size":"smaller"}," All ",-1),Ne=["x"],Ue=["transform"],Ve=["y","width","height","fill"],Te=["x","y"],Ye=["transform"],Ge=["y","width","height","fill"],Xe=["x","y"];$e.render=function(e,t,a,c,d,u){const h=w("Axis");return s(),l("svg",{width:a.width,height:a.height},[o("g",{transform:`translate(${d.margin.left},${d.margin.top})`},[We,o("text",{x:this.chartWidth,y:"0",dy:"-8","text-anchor":"middle","font-size":"smaller"}," Subset ",8,Ne),x(h,{orient:"bottom",scale:u.xscale,translateX:0,translateY:u.chartHeight,type:"category"},null,8,["scale","translateY"]),x(h,{orient:"left",scale:u.yscale,translateX:0,translateY:0,format:d.yaxisformat},null,8,["scale","format"]),x(h,{orient:"right",scale:u.yscale2,translateX:this.chartWidth,translateY:0,format:d.yaxisformat},null,8,["scale","translateX","format"]),(s(!0),l(r,null,n(a.classfeature,(e=>(s(),l("g",{key:"class"+e.category,transform:`translate(${u.xscale(e.category)},0)`},[o("rect",{x:0,y:u.yscale(e.value),width:u.xscale.bandwidth()/2-1,height:u.chartHeight-u.yscale(e.value),fill:this.colorscale(e.category)},null,8,Ve),o("text",{x:u.xscale.bandwidth()/4-1,y:u.yscale(e.value),dy:"-2","text-anchor":"middle","font-size":"10"},i(e.value),9,Te)],8,Ue)))),128)),(s(!0),l(r,null,n(a.subsetclassfeature,(e=>(s(),l("g",{key:"subsetclass"+e.category,transform:`translate(${u.xscale(e.category)+u.xscale.bandwidth()/2+1},0)`},[o("rect",{x:0,y:u.yscale2(e.value),width:u.xscale.bandwidth()/2,height:u.chartHeight-u.yscale2(e.value),fill:this.colorScaleDark(e.category)},null,8,Ge),o("text",{x:u.xscale.bandwidth()/4+1,y:u.yscale2(e.value),dy:"-2","text-anchor":"middle","font-size":"10"},i(e.value),9,Xe)],8,Ye)))),128))],8,Le)],8,He)};var qe=c({name:"Overview",components:{VerticalBarPlot:De,ClassBar:$e,BgColorsOutlined:k},setup(){const e=d("new"),t=M(),a=S({get:()=>t.state.selectedmodels,set(e){t.commit("updateselectedmodelnames",e)}});return{datasetlist:S((()=>t.state.datasetlist)),dataset:S((()=>t.state.dataset)),models:S((()=>t.state.models)),datainfo:S((()=>t.state.datainfo)),modelmetrics:S((()=>t.state.modelinfos)),selectedmodels:a,selecteddata:S((()=>t.state.selecteddata.length)),classfeature:S((()=>t.state.classfeatureinfo)),subsetclassfeature:S((()=>t.state.subsetclassfeature)),colorscale:S((()=>t.state.colorscale)),colorScaleDark:S((()=>t.state.colorscaledark)),selectionmode:e,changeselectionmode:()=>{t.commit("changeselectionmode",e.value)},handleChangeDataset:e=>{e!==t.state.dataset&&t.dispatch("changeDataset",e)},loadNewModels:()=>{t.dispatch("changeModels",a.value)},encodeProjection:e=>{t.dispatch("changeEncodeFeature",e)},selectedmodelmetric:d("accuracy")}}});const Ke=e=>(F("data-v-856d0c54"),e=e(),A(),e),Je={class:"content"},Qe=B(" Datasets: "),Ze=B(" Feature Amount : "),et=B(" Category : "),tt=B(" Data Amount : "),at=B(" Selected Instances : "),st={class:"activetext"},lt=Ke((()=>o("hr",{style:{height:"1px"}},null,-1))),rt=B(" Models: "),nt=B(" Selected models : "),ot={class:"activetext"},it=B("Load"),ct=B("accuracy"),dt=B("precision"),ut=B("f1"),ht={class:"svgcontainer"},mt=Ke((()=>o("hr",{style:{height:"1px"}},null,-1))),ft=B(" Selection Mode: "),pt=Ke((()=>o("span",{class:"icon-new",style:{"font-size":"15px","line-height":"18px","vertical-align":"bottom",display:"inline-block"}},null,-1))),gt=Ke((()=>o("span",{class:"icon-union",style:{"font-size":"22px","line-height":"0","vertical-align":"bottom",display:"inline-block"}},null,-1))),vt=Ke((()=>o("span",{class:"icon-intersect",style:{"font-size":"22px","line-height":"0","vertical-align":"bottom",display:"inline-block"}},null,-1)));qe.render=function(e,t,a,c,d,u){const h=w("a-col"),m=w("a-select-option"),f=w("a-select"),p=w("a-row"),g=w("BgColorsOutlined"),v=w("a-button"),y=w("ClassBar"),b=w("VerticalBarPlot"),k=w("a-radio-button"),S=w("a-radio-group"),M=w("a-space");return s(),l("div",Je,[x(M,{direction:"vertical",size:5},{default:_((()=>[x(p,{type:"flex",justify:"space-between",align:"bottom"},{default:_((()=>[x(h,{flex:"auto",class:"titles"},{default:_((()=>[Qe])),_:1}),x(h,{flex:"170px"},{default:_((()=>[x(f,{value:e.dataset,"onUpdate:value":t[0]||(t[0]=t=>e.dataset=t),style:{width:"170px"},size:"small",onChange:e.handleChangeDataset},{default:_((()=>[(s(!0),l(r,null,n(e.datasetlist,(e=>(s(),j(m,{key:e,value:e},{default:_((()=>[B(i(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","onChange"])])),_:1})])),_:1}),x(p,{type:"flex",justify:"space-between"},{default:_((()=>[x(h,{flex:1,class:"titles"},{default:_((()=>[Ze])),_:1}),x(h,{flex:"100px"},{default:_((()=>[B(i(e.datainfo.featureamount),1)])),_:1})])),_:1}),x(p,{type:"flex",justify:"space-between"},{default:_((()=>[x(h,{flex:1,class:"titles"},{default:_((()=>[et])),_:1}),x(h,{flex:"100px"},{default:_((()=>[B(i(e.datainfo.category)+" ",1),x(v,{size:"small",onClick:t[1]||(t[1]=t=>e.encodeProjection(e.datainfo.category))},{icon:_((()=>[x(g)])),_:1})])),_:1})])),_:1}),x(p,{type:"flex",justify:"space-between"},{default:_((()=>[x(h,{flex:1,class:"titles"},{default:_((()=>[tt])),_:1}),x(h,{flex:"100px"},{default:_((()=>[B(i(e.datainfo.dataamount),1)])),_:1})])),_:1}),x(p,{type:"flex",justify:"space-between"},{default:_((()=>[x(h,{flex:1,class:"titles"},{default:_((()=>[at])),_:1}),x(h,{flex:"100px"},{default:_((()=>[o("div",st,i(e.selecteddata),1)])),_:1})])),_:1}),o("div",null,[x(y,{width:230,height:90,classfeature:e.classfeature,subsetclassfeature:e.subsetclassfeature,colorscale:e.colorscale,colorScaleDark:e.colorScaleDark},null,8,["classfeature","subsetclassfeature","colorscale","colorScaleDark"])]),lt,x(p,{type:"flex",justify:"space-between",align:"middle"},{default:_((()=>[x(h,{flex:"auto",class:"titles"},{default:_((()=>[rt])),_:1}),x(h,{flex:"170px"},{default:_((()=>[x(f,{mode:"multiple",value:e.selectedmodels,"onUpdate:value":t[2]||(t[2]=t=>e.selectedmodels=t),size:"small",style:{width:"170px",height:"45px"},placeholder:"Please select"},{default:_((()=>[(s(!0),l(r,null,n(e.models,(e=>(s(),j(m,{key:e},{default:_((()=>[B(i(e),1)])),_:2},1024)))),128))])),_:1},8,["value"])])),_:1})])),_:1}),x(p,{type:"flex",justify:"space-between",align:"bottom"},{default:_((()=>[x(h,{flex:1,class:"titles"},{default:_((()=>[nt])),_:1}),x(h,{flex:"60px"},{default:_((()=>[o("div",ot,i(e.selectedmodels.length),1)])),_:1}),x(h,{flex:"50px"},{default:_((()=>[x(v,{size:"small",onClick:e.loadNewModels},{default:_((()=>[it])),_:1},8,["onClick"])])),_:1})])),_:1}),x(p,{type:"flex",justify:"space-between",align:"bottom"},{default:_((()=>[x(h,{flex:1,class:"titles"},{default:_((()=>[B(" All "+i(e.models.length)+" models sort by: ",1)])),_:1}),x(h,{flex:"90px"},{default:_((()=>[x(f,{value:e.selectedmodelmetric,"onUpdate:value":t[3]||(t[3]=t=>e.selectedmodelmetric=t),size:"small",style:{width:"90px"},placeholder:"Please select"},{default:_((()=>[x(m,{value:"accuracy"},{default:_((()=>[ct])),_:1}),x(m,{value:"precision"},{default:_((()=>[dt])),_:1}),x(m,{value:"f1"},{default:_((()=>[ut])),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),o("div",ht,[x(b,{mydata:e.modelmetrics,width:220,height:200,selectedmetric:e.selectedmodelmetric},null,8,["mydata","selectedmetric"])]),mt,x(p,{type:"flex",justify:"space-between",align:"middle"},{default:_((()=>[x(h,{flex:"auto",class:"titles"},{default:_((()=>[ft])),_:1}),x(h,{flex:"120px"},{default:_((()=>[x(S,{value:e.selectionmode,"onUpdate:value":t[4]||(t[4]=t=>e.selectionmode=t),"button-style":"solid",size:"small",onChange:e.changeselectionmode},{default:_((()=>[x(k,{value:"new"},{default:_((()=>[pt])),_:1}),x(k,{value:"union"},{default:_((()=>[gt])),_:1}),x(k,{value:"intersection"},{default:_((()=>[vt])),_:1})])),_:1},8,["value","onChange"])])),_:1})])),_:1})])),_:1})])},qe.__scopeId="data-v-856d0c54";var yt=c({name:"BarFeature",props:{data:{type:Array},colorScale:Function,colorScaleDark:Function,chartWidth:Number,chartHeight:Number,subset:{type:Array,default:[]},subsetchecked:Boolean,isDensityShow:Boolean,classes:Array,feautureinfoshow:Boolean},components:{Axis:Ie},setup(t){const s=d(null),l=t.chartWidth,r=t.chartHeight,n=d(),o=S((()=>t.isDensityShow?t=>e(".1f")(t):t=>e(".2~s")(t))),i=S((()=>y().rangeRound([0,l]).paddingInner(.2).domain(t.data.map((e=>e.category))))),c=S((()=>y().padding(.1).rangeRound([0,i.value.bandwidth()]).domain(t.classes)));n.value=a().rangeRound([r,0]).domain([0,b(t.data,(e=>b(e.values,(e=>e.value))))]);const m=(e,t)=>{n.value=a().rangeRound([r,0]).domain([0,b(e,(e=>b(e.values,(e=>e[t]))))])},f=(a,l)=>{const o=v(s.value).select(".chart").selectAll(".slice").data(a,(e=>e.category)).join("g").attr("class","slice").attr("transform",(e=>"translate("+i.value(e.category)+",0)")).selectAll("g").data((e=>e.values),(e=>e.class)).join("g");o.selectAll("rect").data((e=>[e])).join("rect").attr("x",(e=>c.value(e.class))).attr("y",(e=>n.value(l?e.density:e.value))).attr("width",c.value.bandwidth()).attr("height",(e=>r-n.value(l?e.density:e.value))).attr("fill",(e=>t.colorScale(e.class))).attr("fill-opacity",.8),o.selectAll("text").data((e=>[e])).join("text").attr("x",(e=>c.value(e.class)+c.value.bandwidth()/2)).attr("y",(e=>n.value(l?e.density:e.value))).attr("text-anchor","middle").attr("font-size",10).attr("dy",-1).text((t=>l?e(".2f")(t.density):t.value)),t.feautureinfoshow?o.selectAll("text").style("opacity",1):o.selectAll("text").style("opacity",0)},p=(a,l)=>{const o=v(s.value).select(".subsetchart").selectAll(".subsetslice").data(a,(e=>e.category)).join("g").attr("class","subsetslice").attr("transform",(e=>"translate("+i.value(e.category)+",0)")).selectAll("g").data((e=>e.values),(e=>e.class)).join("g");o.selectAll("rect").data((e=>[e])).join("rect").attr("x",(e=>c.value(e.class)+c.value.bandwidth()/4)).attr("y",(e=>n.value(l?e.density:e.value))).attr("width",c.value.bandwidth()/2).attr("height",(e=>r-n.value(l?e.density:e.value))).attr("fill",(e=>t.colorScaleDark(e.class))).attr("stroke","#ffffff").attr("dy",-1).attr("stroke-dasharray",(e=>`${c.value.bandwidth()/2+r-n.value(l?e.density:e.value)} ${c.value.bandwidth()/2}`)),o.selectAll("text").data((e=>[e])).join("text").attr("x",(e=>c.value(e.class)+c.value.bandwidth()/2)).attr("y",(e=>n.value(l?e.density:e.value))).attr("text-anchor","middle").attr("font-size",10).text((t=>l?e(".2f")(t.density):t.value)),t.feautureinfoshow?o.selectAll("text").style("opacity",1):o.selectAll("text").style("opacity",0)};return u((()=>{h((()=>{t.subsetchecked?t.isDensityShow?(m(t.subset,"density"),f([],!0),p(t.subset,!0)):(m(t.subset,"value"),f([],!1),p(t.subset,!1)):t.isDensityShow?(0!==t.subset.length?b(t.data,(e=>b(e.values,(e=>e.density))))>b(t.subset,(e=>b(e.values,(e=>e.density))))?m(t.data,"density"):m(t.subset,"density"):m(t.data,"density"),f(t.data,!0),p(t.subset,!0)):(m(t.data,"value"),f(t.data,!1),p(t.subset,!1))}))})),{svgRef:s,chartHeight:r,x0:i,y:n,yaxisformat:o}}});const bt={ref:"svgRef"},wt=o("g",{class:"chart"},null,-1),xt=o("g",{class:"subsetchart"},null,-1);yt.render=function(e,t,a,r,n,o){const i=w("Axis");return s(),l("g",bt,[x(i,{orient:"bottom",scale:e.x0,translateX:0,translateY:e.chartHeight,type:"category"},null,8,["scale","translateY"]),x(i,{orient:"left",scale:e.y,translateX:0,translateY:0,format:e.yaxisformat},null,8,["scale","format"]),wt,xt],512)};var kt=c({name:"HistogramFeature",props:{data:{type:Array},colorScale:Function,colorScaleDark:Function,chartWidth:Number,chartHeight:Number,subset:{type:Array,default:[]},subsetchecked:Boolean,isDensityShow:Boolean},components:{Axis:Ie},setup(s){const l=d(null),r=s.chartWidth,n=s.chartHeight,o=d(),i=S((()=>s.isDensityShow?t=>e(".2f")(t):t=>e(".2~s")(t))),c=a().rangeRound([0,r]).domain(t(s.data[0].bin_edges)),m=r/s.data[0].bin_edges.length,f=y().padding(0).rangeRound([0,m]).domain(s.data.map((e=>e.class)));o.value=a().rangeRound([n,0]).domain([0,b(s.data,(e=>b(e.hist)))]);const p=(e,t)=>{o.value=a().rangeRound([n,0]).domain([0,b(e,(e=>b(e[t])))])},g=e=>{let t=e.density_hist.map(((t,a)=>[e.bin_edges[a],t]));return t.push([e.bin_edges[e.bin_edges.length-1],0]),t},w=(e,t)=>{const a=v(l.value).select(".chart").selectAll(".slice").data(e).join("g").attr("class","slice");t?(a.selectAll("*").remove(),a.append("path").attr("d",(e=>P().curve(D).x((e=>c(e[0]))).y1((e=>o.value(e[1]))).y0(o.value(0))(g(e)))).attr("fill",(e=>s.colorScale(e.class))).attr("fill-opacity",.3).attr("stroke",(e=>s.colorScale(e.class))).attr("stroke-opacity",.5).attr("stroke-width",1).attr("stroke-linejoin","round")):(a.selectAll("*").remove(),a.selectAll("rect").data((e=>e.hist.map(((t,a)=>[e.class,e.bin_edges[a],t])))).join("rect").attr("transform",(e=>"translate("+c(e[1])+",0)")).attr("x",(e=>f(e[0]))).attr("y",(e=>o.value(e[2]))).attr("width",f.bandwidth()).attr("height",(e=>n-o.value(e[2]))).attr("fill",(e=>s.colorScale(e[0]))).attr("fill-opacity",.8))},x=(e,t)=>{const a=v(l.value).select(".subsetchart").selectAll(".subsetslice").data(e).join("g").attr("class","subsetslice");t?(a.selectAll("*").remove(),a.append("path").attr("d",(e=>R().curve(D).x((e=>c(e[0]))).y((e=>o.value(e[1])))(g(e)))).attr("fill","none").attr("stroke",(e=>s.colorScaleDark(e.class))).attr("stroke-width",1.5).attr("stroke-linejoin","round")):(a.selectAll("*").remove(),a.selectAll("rect").data((e=>e.hist.map(((t,a)=>[e.class,e.bin_edges[a],t])))).join("rect").attr("transform",(e=>"translate("+c(e[1])+",0)")).attr("x",(e=>f(e[0]))).attr("y",(e=>o.value(e[2]))).attr("width",f.bandwidth()).attr("height",(e=>n-o.value(e[2]))).attr("fill",(e=>s.colorScaleDark(e[0]))).attr("stroke","#ffffff").attr("stroke-dasharray",`${f.bandwidth()} ${3*n}`))};return u((()=>{h((()=>{s.subsetchecked?s.isDensityShow?(p(s.subset,"density_hist"),w([],!0),x(s.subset,!0)):(p(s.subset,"hist"),w([],!1),x(s.subset,!1)):s.isDensityShow?(0!==s.subset.length?b(s.data,(e=>b(e.density_hist)))>b(s.subset,(e=>b(e.density_hist)))?p(s.data,"density_hist"):p(s.subset,"density_hist"):p(s.data,"density_hist"),w(s.data,!0),x(s.subset,!0)):(p(s.data,"hist"),w(s.data,!1),x(s.subset,!1))}))})),{svgRef:l,chartHeight:n,x0:c,y:o,ticks:7,yaxisformat:i}}});const St={ref:"svgRef"},Mt=o("g",{class:"chart"},null,-1),_t=o("g",{class:"subsetchart"},null,-1);kt.render=function(e,t,a,r,n,o){const i=w("Axis");return s(),l("g",St,[x(i,{orient:"bottom",scale:e.x0,translateX:0,translateY:e.chartHeight,ticks:e.ticks},null,8,["scale","translateY","ticks"]),x(i,{orient:"left",scale:e.y,translateX:0,translateY:0,format:e.yaxisformat},null,8,["scale","format"]),Mt,_t],512)};var jt=c({name:"FeatureUse",props:["featureusestate","chartWidth","chartHeight"],computed:{gridWidth(){return this.chartWidth/this.featureusestate.modeluse.length},featureuse(){return this.$store.state.featureuse},selectedfeatures(){return this.$store.state.selectedfeatures}},methods:{handlemodelclick(e){const t=document.getElementById(`shapfeature-${e}-${this.featureusestate.feature}`);null==t||t.scrollIntoView()}}});const Bt=["x","width","height","fill","onClick"];jt.render=function(e,t,a,c,d,u){return s(),l("g",null,[(s(!0),l(r,null,n(e.featureusestate.modeluse,((t,a)=>(s(),l("rect",{key:t.feature,x:e.gridWidth*a,y:"2",width:e.gridWidth,height:e.chartHeight-4,stroke:"#ffffff",fill:t[1]?"#999999":"white",onClick:a=>e.handlemodelclick(t[0])},[o("title",null,i(t[0]),1)],8,Bt)))),128))])},jt.__scopeId="data-v-71f7579f";var Ft=c({name:"FeatureInfo",props:["feature","subsetchecked","featureusestate","chartWidth","chartHeight","transform","isDensityShow","classes"],components:{BarFeature:yt,HistogramFeature:kt,FeatureUse:jt,PlusOutlined:z,MinusOutlined:C,BgColorsOutlined:k,InfoOutlined:E},setup(e){const t=M(),a={left:25,bottom:25,top:9,right:10},s=408-a.left-a.right,l=75-a.top-a.bottom,r=d(!1);return{handleAddFeature:()=>{t.state.selectedfeatures.includes(e.feature.feature)||t.commit("updateSelectedFeatures",t.state.selectedfeatures.concat([e.feature.feature]))},handleDeleteFeature:()=>{t.state.selectedfeatures.includes(e.feature.feature)&&t.commit("updateSelectedFeatures",t.state.selectedfeatures.filter((t=>t!==e.feature.feature)))},colorScale:S((()=>t.state.colorscale)),colorScaleDark:S((()=>t.state.colorscaledark)),width:408,height:75,chartWidth:s,chartHeight:l,margin:a,encodeProjection:()=>{t.dispatch("changeEncodeFeature",e.feature.feature)},feautureinfoshow:r,togglefeatureinfo:()=>{r.value=!r.value}}}});const At=["id"],Pt={class:"featurehead"},Dt=["title"],Rt={class:"featurebuttons"},zt=["width","height"],Ct=["transform"],Et=["transform"];Ft.render=function(e,t,a,r,n,c){const d=w("InfoOutlined"),u=w("a-button"),h=w("BgColorsOutlined"),m=w("PlusOutlined"),f=w("MinusOutlined"),p=w("BarFeature"),g=w("HistogramFeature"),v=w("FeatureUse");return s(),l("div",{style:{height:"100px"},id:`feature-${e.feature.feature}`},[o("div",Pt,[o("div",{class:"featurename",title:e.feature.feature},i(e.feature.feature),9,Dt),o("div",Rt,["categorical"===e.feature.type?(s(),j(u,{key:0,size:"small",onClick:e.togglefeatureinfo},{icon:_((()=>[x(d)])),_:1},8,["onClick"])):I("",!0),x(u,{size:"small",onClick:e.encodeProjection},{icon:_((()=>[x(h)])),_:1},8,["onClick"]),x(u,{size:"small",onClick:e.handleAddFeature},{icon:_((()=>[x(m)])),_:1},8,["onClick"]),x(u,{size:"small",onClick:e.handleDeleteFeature},{icon:_((()=>[x(f)])),_:1},8,["onClick"])])]),o("div",null,[(s(),l("svg",{width:e.width,height:e.height},[o("g",{transform:"translate("+e.margin.left+","+e.margin.top+")"},["categorical"===e.feature.type?(s(),j(p,{key:0,data:e.feature.data,colorScale:e.colorScale,colorScaleDark:e.colorScaleDark,chartWidth:e.chartWidth,chartHeight:e.chartHeight,subset:e.feature.subset,subsetchecked:e.subsetchecked,isDensityShow:e.isDensityShow,classes:e.classes,feautureinfoshow:e.feautureinfoshow},null,8,["data","colorScale","colorScaleDark","chartWidth","chartHeight","subset","subsetchecked","isDensityShow","classes","feautureinfoshow"])):(s(),j(g,{key:1,data:e.feature.data,colorScale:e.colorScale,colorScaleDark:e.colorScaleDark,chartWidth:e.chartWidth,chartHeight:e.chartHeight,subset:e.feature.subset,subsetchecked:e.subsetchecked,isDensityShow:e.isDensityShow},null,8,["data","colorScale","colorScaleDark","chartWidth","chartHeight","subset","subsetchecked","isDensityShow"]))],8,Ct),o("g",{transform:"translate(10,"+(e.chartHeight+e.margin.top+15)+")"},[x(v,{featureusestate:e.featureusestate,chartWidth:e.width-10,chartHeight:e.margin.bottom-15},null,8,["featureusestate","chartWidth","chartHeight"])],8,Et)],8,zt))])],8,At)},Ft.__scopeId="data-v-4b10cc74";const It={name:"FeatureDistribution",components:{FeatureInfo:Ft},setup(){const e=M(),t=d(!1),a=d(!1),s=d("modeluse"),l=(e,t)=>{const a=new Map;return e.forEach((e=>{if("numerical"===e.type){let s;if("mix"===t){s=e.subset;const t=s[0].class;s=s.concat(e.data.filter((e=>e.class!==t)))}else s=e[t];const l=s.map((e=>e.density_hist)),r=s[0].bin_edges[1]-s[0].bin_edges[0],n=l.length,o=l[0].length,i=[];for(let e=0;e<o;e++){let t;for(let a=0;a<n;a++)(0===a||l[a][e]>t)&&(t=l[a][e]);i.push(t)}a.set(e.feature,O(i)*r)}else{const s=[];let l;if("mix"===t){const t=e.subset[0].values[0].class;l=JSON.parse(JSON.stringify(e.data)),l.forEach((a=>{a.values=a.values.filter((e=>e.class!==t));const s=e.subset.find((e=>e.category===a.category));void 0!==s&&(a.values=a.values.concat(s.values))}))}else l=e[t];l.forEach((e=>{s.push(b(e.values.map((e=>e.density))))})),a.set(e.feature,O(s))}})),e.sort(((e,t)=>{const s=a.get(t.feature),l=a.get(e.feature);return s===l?("categorical"===t.type)-("categorical"===e.type):s-l}))},r=S((()=>e.getters.featuredistribution)),n=S((()=>e.getters.featureusestate)),o=S((()=>{if("modeluse"===s.value){const e=new Map;return n.value.forEach((t=>{e.set(t.feature,O(t.modeluse.map((e=>e[1]))))})),r.value.sort(((t,a)=>e.get(a.feature)-e.get(t.feature)))}return"classdiff"===s.value?l(r.value,"data"):r.value[0].subset.length>0?(e=>{if("numerical"===e.type)return 1===e.subset.length;{const t=e.subset.flatMap((e=>e.values.flatMap((e=>e.class))));return 1==new Set(t).size}})(r.value[0])?l(r.value,"mix"):l(r.value,"subset"):l(r.value,"data")}));return{onlyShowSubset:t,isDensityShow:a,sortmethod:s,featureusestate:n,sortedfeatureinfos:o,loadingstatus:S((()=>e.state.distributionloading)),classes:S((()=>e.state.classes))}}},Ot={key:0,class:"loadingcontainer"},$t={key:1,class:"distributions"},Ht={class:"header"},Lt=B(" Sort By: "),Wt=B("Use Frequency"),Nt=B("Global Difference"),Ut=B("Subset Difference"),Vt=B(" Subset: "),Tt=B(" Prob: "),Yt={class:"content"},Gt={class:"svgcontent"};It.render=function(e,t,a,i,c,d){const u=w("a-spin"),h=w("a-select-option"),m=w("a-select"),f=w("a-switch"),p=w("FeatureInfo");return i.loadingstatus?(s(),l("div",Ot,[x(u,{tip:"Loading..."})])):(s(),l("div",$t,[o("div",Ht,[Lt,x(m,{value:i.sortmethod,"onUpdate:value":t[0]||(t[0]=e=>i.sortmethod=e),style:{width:"120px"},size:"small"},{default:_((()=>[x(h,{value:"modeluse"},{default:_((()=>[Wt])),_:1}),x(h,{value:"classdiff"},{default:_((()=>[Nt])),_:1}),x(h,{value:"subsetdiff"},{default:_((()=>[Ut])),_:1})])),_:1},8,["value"]),Vt,x(f,{size:"small",checked:i.onlyShowSubset,"onUpdate:checked":t[1]||(t[1]=e=>i.onlyShowSubset=e)},null,8,["checked"]),Tt,x(f,{size:"small",checked:i.isDensityShow,"onUpdate:checked":t[2]||(t[2]=e=>i.isDensityShow=e)},null,8,["checked"])]),o("div",Yt,[o("div",Gt,[(s(!0),l(r,null,n(i.sortedfeatureinfos,(e=>(s(),j(p,{key:e.feature,feature:e,subsetchecked:i.onlyShowSubset,isDensityShow:i.isDensityShow,featureusestate:i.featureusestate.find((t=>t.feature===e.feature)),classes:i.classes},null,8,["feature","subsetchecked","isDensityShow","featureusestate","classes"])))),128))])])]))},It.__scopeId="data-v-688513af";const Xt=(e,t=null,a)=>{a||(a=e.map((e=>e.name)));const s=a.length;let l,r,n,o;const i=[],c=e.find((e=>"label"===e.name)).value;for(let d=0;d<s-1;d++){n=a[d],o=a[d+1],l=e.find((e=>e.name===n)).value,r=e.find((e=>e.name===o)).value;const s={};let u,h,m,f;null===t?l.forEach(((e,t)=>{if(u=c[t],h=r[t],m=n+"-"+e+"-"+u,f=o+"-"+h+"-"+u,!(m in s)){const e={};s[m]=e}m in s&&(f in s[m]?s[m][f]++:s[m][f]=1)})):t.forEach((e=>{u=c[e];const t=l[e];if(h=r[e],m=n+"-"+t+"-"+u,f=o+"-"+h+"-"+u,!(m in s)){const e={};s[m]=e}m in s&&(f in s[m]?s[m][f]++:s[m][f]=1)})),Object.keys(s).forEach((e=>{const t=s[e];Object.keys(t).forEach((a=>{i.push({sourcename:e,targetname:a,values:t[a]})}))}))}return i},qt=function(e){let t=[],a=1e4,s=function(){},l=function(){};var r=function(e){e&&r.data(e),s(),l(),r.render()};r.render=function(){let l=!0;s=r.invalidate=function(){l=!1},function s(){if(!l)return!0;t.splice(0,a).map(e),n(s)}()},r.data=function(e){return s(),t=e.slice(0),r},r.add=function(e){t=t.concat(e)},r.rate=function(e){return arguments.length?(a=e,r):a},r.remaining=function(){return t.length},r.clear=function(e){return arguments.length?(l=e,r):(l(),r)},r.invalidate=s;var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};return r},Kt=function({svg:t,color:s,title:l,tickSize:r=6,width:n=120,height:o=44+r,marginTop:i=16,marginRight:c=0,marginBottom:d=16+r,marginLeft:u=5,ticks:h=n/40,tickFormat:m,tickValues:f}={}){t.selectAll("*").remove();let g,v=e=>e.selectAll(".tick line").attr("y1",i+d-o);if(s.interpolate){const e=Math.min(s.domain().length,s.range().length);g=s.copy().rangeRound($(H(u,n-c),e)),t.append("image").attr("x",u).attr("y",i).attr("width",n-u-c).attr("height",o-i-d).attr("preserveAspectRatio","none").attr("xlink:href",Jt(s.copy().domain($(H(0,1),e))).toDataURL())}else if(s.interpolator){if(g=Object.assign(s.copy().interpolator(L(u,n-c)),{range:()=>[u,n-c]}),t.append("image").attr("x",u).attr("y",i).attr("width",n-u-c).attr("height",o-i-d).attr("preserveAspectRatio","none").attr("xlink:href",Jt(s.interpolator()).toDataURL()),!g.ticks){if(void 0===f){const e=Math.round(h+1);f=W(e).map((t=>N(s.domain(),t/(e-1))))}"function"!=typeof m&&(m=e(void 0===m?",f":m))}}else if(s.invertExtent){const l=s.thresholds?s.thresholds():s.quantiles?s.quantiles():s.domain(),r=void 0===m?e=>e:"string"==typeof m?e(m):m;g=a().domain([-1,s.range().length-1]).rangeRound([u,n-c]),t.append("g").selectAll("rect").data(s.range()).join("rect").attr("x",((e,t)=>g(t-1))).attr("y",i).attr("width",((e,t)=>g(t)-g(t-1))).attr("height",o-i-d).attr("fill",(e=>e)),f=W(l.length),m=e=>r(l[e],e)}else g=y().domain(s.domain()).rangeRound([u,n-c]),t.append("g").selectAll("rect").data(s.domain()).join("rect").attr("x",g).attr("y",i).attr("width",Math.max(0,g.bandwidth()-1)).attr("height",o-i-d).attr("fill",s),v=()=>{};return t.append("g").attr("transform",`translate(0,${o-d})`).call(p(g).ticks(h,"string"==typeof m?m:void 0).tickFormat("function"==typeof m?m:void 0).tickSize(r).tickValues(f)).call(v).call((e=>e.select(".domain").remove())).call((e=>e.append("text").attr("x",u).attr("y",i+d-o-6).attr("fill","currentColor").attr("text-anchor","start").attr("font-weight","bold").attr("font-size","1.3em").text(l))),t.node()};function Jt(e,t=256){const a=document.createElement("canvas");a.width=t,a.height=1;const s=a.getContext("2d");for(let l=0;l<t;++l)s.fillStyle=e(l/(t-1)),s.fillRect(l,0,1,1);return a}function Qt(e){return e.nodes}function Zt(e){return e.links}function ea(e){return e.compressed}function ta(e){return function(){return e}}function aa(){let e=0,t=0,a=1,s=1;const l=28;let r=6;let n=Qt,o=Zt;const i=ea;let c,d=1;function u(){const e={nodes:n.apply(null,arguments),links:o.apply(null,arguments),nodeMap:new Map},t=i.apply(null,arguments);return t?(f(e),p(e)):(g(e),v(e)),e}function h(e,t,a){const s=[];if(e.length>0){const l=t.find((e=>"label"===e.name)).value,r={};t.forEach((t=>{const a=t.value,s=t.name;e.forEach((e=>{const t=s+"-"+a[e]+"-"+l[e];r.hasOwnProperty(t)?r[t]++:r[t]=1}))})),a.forEach(((e,t)=>{const a=r[t];if(a>0){const l={},r=e.y0;l.name=t,l.value=a,l.x0=e.x0,l.y0=r+a/e.value*(e.y1-r),l.x1=e.x1,l.y1=e.y1,l.isTP=e.isTP,s.push(l)}else s.push(e)}))}return s}function m(e,t,a,s){const l={links:Xt(t,e,c),nodeMap:a};return s?p(l):v(l),l.links}function f({nodes:n,nodeMap:o}){const i=Object.keys(n[0].value).length,c=Math.max(...n.map((e=>U.sum(Object.entries(e.value).map((e=>U.sum(Object.entries(e[1].children).filter((t=>t[0]!==e[0])).map((e=>e[1].value))))))))),d=n.length,u=(a-e-l)/(d-1);let h=0;const m=(s-t-5*(i-1)-10*i)/c;for(const a of n){let s=t;const n=a.name,i=a.value;a.x=e+h*u+14;for(const t in i){const a=i[t];a.layer=h,a.x0=e+h*u,a.x1=a.x0+l,a.y0=s;let c=s;const d=Object.keys(a.children).sort(((e,a)=>e==t?-1:a==t?1:0));for(const e of d){const s=a.children[e];s.x0=a.x0+r,s.x1=a.x1-r,e===t?(s.y0=c,s.y1=s.y0+10,s.isTP=!0):(s.y0=c+0,s.y1=s.y0+s.value*m,s.isTP=!1),s.name=n+"-"+t+"-"+e,c=s.y1,o.set(s.name,s)}a.y1=c,s=a.y1+5}h++}}function p({links:e,nodeMap:t}){const a=U.groupBy(e,(e=>e.sourcename));Object.keys(a).sort(((e,t)=>t<e?1:-1)).forEach((e=>{const s=e.split("-").pop(),l=t.get(e),n=l.x1+r+d,o=a[e].sort(((e,t)=>t.targetname<e.targetname?1:-1));if(!0===l.isTP){const e=(l.y1+l.y0)/2;o.forEach((t=>{t.sourcewidth=2,t.source=[n,e],t.label=s,t.isblur=1}))}else{const e=(l.y1-l.y0)/l.value;let t=l.y0;o.forEach((a=>{a.sourcewidth=a.values*e,a.source=[n,t+a.sourcewidth/2],a.label=s,a.isblur=0,t+=a.sourcewidth}))}}));const s=U.groupBy(e,(e=>e.targetname));Object.keys(s).forEach((e=>{const a=e.split("-").pop(),l=t.get(e),n=l.x0-r-d,o=s[e].sort(((e,t)=>t.sourcename<e.sourcename?1:-1));if(!0===l.isTP){const e=(l.y1+l.y0)/2;o.forEach((t=>{t.targetwidth=2,t.target=[n,e],t.label=a,t.isblur++}))}else{const e=(l.y1-l.y0)/l.value;let t=l.y0;o.forEach((s=>{s.targetwidth=s.values*e,s.target=[n,t+s.targetwidth/2],s.label=a,t+=s.targetwidth}))}}))}function g({nodes:n,nodeMap:o}){const i=Math.max(...n.map((e=>Object.values(e.value).map((e=>e.value)).reduce(((e,t)=>e+t))))),c=n.length,d=(a-e-l)/(c-1);let u=0;for(const a of n){const n=(s-t-5*(Object.keys(a).length-1))/i;let c=t;const h=a.name,m=a.value;a.x=e+u*d+14;for(const t in m){const a=m[t];a.layer=u,a.x0=e+u*d,a.x1=a.x0+l,a.y0=c,a.y1=c+a.value*n;const s=(a.value*n-0*(Object.keys(a.children).length+1))/a.value;let i=c;c=a.y1+5;for(const e in a.children){const l=a.children[e];l.x0=a.x0+r,l.x1=a.x1-r,l.y0=i+0,l.y1=l.y0+l.value*s,l.name=h+"-"+t+"-"+e,i=l.y1+0,o.set(l.name,l)}}u++}}function v({links:e,nodeMap:t}){const a=U.groupBy(e,(e=>e.sourcename));Object.keys(a).sort(((e,t)=>t<e?1:-1)).forEach((e=>{const s=e.split("-").pop(),l=t.get(e),n=(l.y1-l.y0)/l.value;let o=l.y0;const i=l.x1+r+d;a[e].sort(((e,t)=>t.targetname<e.targetname?1:-1)).forEach((e=>{e.sourcewidth=e.values*n,e.source=[i,o+e.sourcewidth/2],e.label=s,o+=e.sourcewidth}))}));const s=U.groupBy(e,(e=>e.targetname));Object.keys(s).forEach((e=>{const a=e.split("-").pop(),l=t.get(e),n=(l.y1-l.y0)/l.value;let o=l.y0;const i=l.x0-r-d;s[e].sort(((e,t)=>t.sourcename<e.sourcename?1:-1)).forEach((e=>{e.targetwidth=e.values*n,e.target=[i,o+e.targetwidth/2],e.label=a,o+=e.targetwidth}))}))}return u.nodes=function(e){return arguments.length?(n="function"==typeof e?e:ta(e),u):n},u.links=function(e){return arguments.length?(o="function"==typeof e?e:ta(e),u):callinks},u.extent=function(l){return arguments.length?(e=+l[0][0],a=+l[1][0],t=+l[0][1],s=+l[1][1],u):[[e,t],[a,s]]},u.interval=function(e){return arguments.length?(d=+e,u):d},u.outnodewidth=function(e){return arguments.length?(r=+e,u):r},u.getSelectedNodes=function(e,t,a){return function(e,t,a,s){return{nodes:h(e,a,t),links:m(e,a,t,s)}}(e,t,a)},u.calProbLinks=function(e,t,a){return calProbLinks(e,t,a)},u.getsortedmodelnames=function(e){return arguments.length?(c=e,u):c},u}const sa=()=>{const e=d(),t=V({dimensions:{}}),a=new ResizeObserver((e=>{e.forEach((e=>{t.dimensions=e.contentRect}))}));return u((()=>{t.dimensions=e.value.getBoundingClientRect(),a.observe(e.value)})),T((()=>{a.unobserve(e.value)})),{resizeState:t,resizeRef:e}};const la={name:"SankeyGraph",props:{sankeyGraph:{type:Object,default:{nodes:[],links:[]}},sankey:Function,compresschecked:Boolean,predictions:Array,sortedmodelnames:Array},data:()=>({ctx:null,probScaleMap:new Map}),setup(t){const a=Y.lines().size(5).strokeWidth(2).stroke("white"),s=M(),l=s.state.colorscale,r=e(".1%"),n=d(new Set);let o,i,c,h=0;function m(e,t){o=v(this).clone(!0).raise().attr("class","clone");const a=o.node().getBBox();o.append("rect").attr("x",t.x-a.width/2-5).attr("width",a.width+10).attr("height",a.height).attr("fill","#ffffff").attr("stroke","#efefef").attr("filter","url(#shadow)").lower(),h=e.x,o.attr("transform-origin","center").attr("opacity",.8),i=a.width/2,c=v("#sankey").node().getBBox().width-a.width/2}function f(e,t){const a=e.x>=i?e.x<c?e.x:c:i;o.attr("transform",(function(e){return"scale(1.05) translate("+(a-h)+",0)"}))}function p(e,a){o.remove();const{nodes:l}=t.sankeyGraph,r=l.map((t=>t.name!==a.name?{name:t.name,x:t.x}:{name:t.name,x:e.x}));r.sort(((e,t)=>e.x-t.x)),s.commit("updatesortedmodelnames",r.map((e=>e.name)))}const g=(e,a)=>{const n=e.selectAll("g.axis").data(a,(e=>e.name)).join((function(e){const t=e.append("g").attr("class","axis");return t.append("text").attr("class","modelnanme").attr("x",(e=>e.x)).attr("y",0).attr("dy",".35em").attr("text-anchor","middle").attr("font-size",16).attr("fill","black").style("cursor","grab").text((e=>e.name)),t.append("text").attr("class","modelacc").attr("x",(e=>e.x)).attr("y",25).attr("dy",".35em").attr("text-anchor","middle").attr("font-size",12).attr("fill","black").text((e=>e.accuracy?r(e.accuracy):"")),t.selection()}),(function(e){return e.select(".modelnanme").attr("x",(e=>e.x)),e.select(".modelacc").attr("x",(e=>e.x)),e.selection()}));n.filter((e=>"label"!==e.name)).call(q().on("start",m).on("drag",f).on("end",p).filter((e=>e.shiftKey)).container((function(){return this}))),n.each((function(e){v(this).selectAll("g.bg").data(Object.entries(e.value),(e=>e[0])).join((function(e){const t=e.append("g").attr("class","bg");return t.append("rect").attr("class","leftnode").attr("x",(e=>e[1].x0)).attr("y",(e=>e[1].y0)).attr("height",(e=>e[1].y1-e[1].y0)).attr("width",4).attr("fill",(e=>l(e[0]))),t.append("rect").attr("class","rightnode").attr("x",(e=>e[1].x1-4)).attr("y",(e=>e[1].y0)).attr("height",(e=>e[1].y1-e[1].y0)).attr("width",4).attr("fill",(e=>l(e[0]))),t.selection()}),(function(e){return e.select(".leftnode").attr("x",(e=>e[1].x0)).attr("y",(e=>e[1].y0)).attr("height",(e=>e[1].y1-e[1].y0)).attr("fill",(e=>l(e[0]))),e.select(".rightnode").attr("x",(e=>e[1].x1-4)).attr("y",(e=>e[1].y0)).attr("height",(e=>e[1].y1-e[1].y0)).attr("fill",(e=>l(e[0]))),e.selection()})).selectAll("rect.snode").data((e=>Object.entries(e[1].children))).join((function(e){return e.append("rect").attr("class","snode").attr("x",(e=>e[1].x0)).attr("y",(e=>e[1].y0)).attr("height",(e=>e[1].y1-e[1].y0)).attr("width",(e=>e[1].x1-e[1].x0)).attr("fill",(e=>l(e[0]))).attr("filter",(e=>!0===e[1].isTP&&t.compresschecked?"url(#blurMe)":"none")).on("click",(function(e,a){"models"!==s.state.currentfocus&&s.commit("changeSelectionFocus","models"),s.commit("updateSelectedData",t.sankeyGraph.nodeMap.get(a[1].name).values)})).on("mouseenter",(function(e){e.shiftKey||(v(this).style("stroke","black"),e.stopPropagation())})).on("mouseleave",(function(e){v(this).style("stroke","none"),e.stopPropagation()})).selection()}),(function(e){return e.attr("x",(e=>e[1].x0)).attr("y",(e=>e[1].y0)).attr("height",(e=>e[1].y1-e[1].y0)).attr("width",(e=>e[1].x1-e[1].x0)).attr("filter",(e=>!0===e[1].isTP&&t.compresschecked?"url(#blurMe)":"none")).attr("fill",(e=>l(e[0]))),e.selection()}))}))},y=({nodes:e,links:a})=>{const s=v("#sankey");g(s,e),((e,a,s=[])=>{t.compresschecked?e.select("#links").selectAll(".link").data(a,(e=>e.sourcename+e.targetname)).join("path").attr("class","link").attr("d",(e=>P().curve(K).x((e=>e.x)).y0((e=>e.y0)).y1((e=>e.y1))([{x:e.source[0],y0:e.source[1]-e.sourcewidth/2,y1:e.source[1]+e.sourcewidth/2},{x:e.target[0],y0:e.target[1]-e.targetwidth/2,y1:e.target[1]+e.targetwidth/2}]))).attr("fill",(e=>l(e.label))).attr("fill-opacity",(e=>2===e.isblur?.3:1)).attr("stroke","none").style("mix-blend-mode","multiply"):e.select("#links").selectAll(".link").data(a,(e=>e.sourcename+e.targetname)).join("path").attr("class","link").attr("d",J()).attr("fill","none").attr("stroke",(e=>l(e.label))).attr("stroke-width",(e=>e.sourcewidth)).style("mix-blend-mode","multiply")})(s,a)},b=e=>{if(t.sankey){const s=(new Date).getTime(),{nodes:r,links:o}=t.sankey.getSelectedNodes(e,t.sankeyGraph.nodeMap,t.predictions,t.compresschecked,t.sortedmodelnames);(new Date).getTime();(e=>{v("#selectedNodes").selectAll("rect.selectednode").data(t.compresschecked?e.filter((e=>!1===e.isTP)):e).join("rect").attr("class","selectednode").attr("x",(e=>e.x0)).attr("y",(e=>e.y0)).attr("height",(e=>e.y1-e.y0)).attr("width",(e=>e.x1-e.x0)).attr("fill",a.url())})(r),(e=>{0===e.length&&0===n.value.size?v("#links").selectAll(".link").style("opacity",1):v("#links").selectAll(".link").style("opacity",0),t.compresschecked?v("#selectedLinks").selectAll(".link").data(e,(e=>e.sourcename+e.targetname)).join("path").attr("class","link").attr("d",(e=>P().curve(K).x((e=>e.x)).y0((e=>e.y0)).y1((e=>e.y1))([{x:e.source[0],y0:e.source[1]-e.sourcewidth/2,y1:e.source[1]+e.sourcewidth/2},{x:e.target[0],y0:e.target[1]-e.targetwidth/2,y1:e.target[1]+e.targetwidth/2}]))).attr("fill",(e=>l(e.label))).attr("stroke",(e=>l(e.label))).attr("stroke-width",.5).style("mix-blend-mode","multiply").style("opacity",1):v("#selectedLinks").selectAll(".link").data(e).join("path").attr("fill","none").attr("class","link").attr("d",J()).attr("stroke",(e=>l(e.label))).attr("stroke-width",(e=>e.sourcewidth)).style("mix-blend-mode","multiply").style("opacity",1)})(o)}};return u((()=>{v("#sankey").call(a),y(t.sankeyGraph)})),G((()=>t.sankeyGraph),(e=>{y(e),b(s.state.selecteddata)})),G((()=>s.state.selecteddata),(e=>{b(e)}),{deep:!0}),G((()=>s.state.selectionfocus),(e=>{"models"!==e&&(n.value.clear(),X(".snode").style("stroke","none"))})),{colorScale:l}},methods:{}},ra=e=>(F("data-v-50812de8"),e=e(),A(),e),na=ra((()=>o("filter",{id:"boxshadow","color-interpolation-filters":"sRGB"},[o("feDropShadow",{dx:"0",dy:"0",stdDeviation:"2","flood-color":"#aaaaaa","flood-opacity":"0.4"})],-1))),oa=ra((()=>o("filter",{id:"blurMe"},[o("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"4"})],-1))),ia=ra((()=>o("g",{id:"sankey"},[o("g",{id:"links"})],-1))),ca=ra((()=>o("g",{id:"selectedNodes"},null,-1))),da=ra((()=>o("g",{id:"selectedLinks"},null,-1)));la.render=function(e,t,a,n,o,i){return s(),l(r,null,[na,oa,ia,ca,da],64)},la.__scopeId="data-v-50812de8";var ua={name:"ParallelSet",props:{predictions:{type:Array,default:[{name:"label",value:[]}]},sortedmodelnames:{type:Array}},components:{SankeyGraph:la},setup(e){const{resizeRef:t,resizeState:a}=sa(),s={top:40,bottom:20,left:20,right:20},l=d(),r=d(),n=d(!1);let o,i;const c=t=>{const a=v("#sankeysvg"),{width:c,height:d}=t,u=c-s.left-s.right,h=d-s.top-s.bottom;a.attr("viewBox",[0,0,c,d]),e.predictions.length>0&&(o=((e,t)=>{const a=[],s=e.find((e=>"label"===e.name)).value;let l;return e.forEach((e=>{const t={};e.value.forEach(((e,a)=>{e in t?t[e].value++:t[e]={value:1,children:{}},l=s[a],l in t[e].children?(t[e].children[l].value++,t[e].children[l].values.push(a)):(t[e].children[l]={value:1},t[e].children[l].values=[a])})),a.push({name:e.name,accuracy:e.accuracy,value:t})})),a.sort(((e,a)=>t.indexOf(e.name)-t.indexOf(a.name))),a})(e.predictions,e.sortedmodelnames),i=Xt(e.predictions,null,e.sortedmodelnames),l.value=aa().extent([[0,s.top],[u,h]]).interval(3).outnodewidth(6),r.value=l.value({nodes:o,links:i,compressed:n.value}),l.value.getsortedmodelnames(e.sortedmodelnames))};return G((()=>a.dimensions),((e,t)=>{e.width===t.width&&e.height===t.height||c(e)})),G((()=>e.sortedmodelnames),(()=>{c(a.dimensions)})),G(n,(e=>{r.value=l.value({nodes:o,links:i,compressed:e})})),{sankey:l,sankeyGraph:r,resizeRef:t,margin:s,compresschecked:n}}};const ha=e=>(F("data-v-642ed0f8"),e=e(),A(),e),ma={id:"parallelset",ref:"resizeRef"},fa={class:"controlpanel"},pa=ha((()=>o("span",{style:{"vertical-align":"middle"}},"Misclassification View: ",-1))),ga=ha((()=>o("div",{style:{position:"relative",float:"right","margin-right":"14px","margin-top":"2px",color:"#898989"}},[B("* "),o("span",{style:{"font-weight":"bold"}},"Drag"),B(" : "),o("span",{class:"keyboard"},"Shift"),B(" + Click ")],-1))),va={id:"sankeysvg"},ya=["transform"];ua.render=function(e,t,a,r,n,i){const c=w("a-switch"),d=w("SankeyGraph");return s(),l("div",ma,[o("div",fa,[pa,x(c,{checked:r.compresschecked,"onUpdate:checked":t[0]||(t[0]=e=>r.compresschecked=e),size:"small"},null,8,["checked"]),ga]),(s(),l("svg",va,[o("g",{transform:"translate("+r.margin.left+","+r.margin.top+")"},[x(d,{sankeyGraph:r.sankeyGraph,sankey:r.sankey,compresschecked:r.compresschecked,predictions:a.predictions,sortedmodelnames:a.sortedmodelnames},null,8,["sankeyGraph","sankey","compresschecked","predictions","sortedmodelnames"])],8,ya)]))],512)},ua.__scopeId="data-v-642ed0f8";const ba={name:"BarStatistics",props:["bardata","width","height","margin","mouseEnterModelBar","mouseLeaveModelBar","selectedmodel"],components:{Axis:Ie},data:()=>({yaxisformat:function(t){return e(".1f")(t)}}),computed:{chartWidth(){return this.width-this.margin.right-this.margin.left},chartHeight(){return this.height-this.margin.top-this.margin.bottom},xscale(){return y().domain(this.bardata.map((e=>e.name))).range([0,this.chartWidth]).padding(.3)},yscale(){return a().domain([0,1]).range([this.chartHeight,0])},selectedbar(){return this.selectedmodel?this.bardata.find((e=>e.name===this.selectedmodel)).value:0},hovery(){return this.selectedmodel?this.yscale(this.selectedbar):0},formatinfo:()=>e(".2f")}},wa=["transform"],xa=["x","y","width","height","onMouseenter","onMouseleave"],ka=["y1","x2","y2"],Sa=["x","y"];ba.render=function(e,t,a,o,c,d){const u=w("Axis");return s(),l("g",{ref:"gRef",transform:`translate(${a.margin.left},${a.margin.top})`},[x(u,{orient:"bottom",scale:d.xscale,translateX:0,translateY:d.chartHeight,type:"category",rotatestyle:!0},null,8,["scale","translateY"]),x(u,{orient:"left",scale:d.yscale,translateX:0,translateY:0,format:c.yaxisformat},null,8,["scale","format"]),(s(!0),l(r,null,n(a.bardata,(e=>(s(),l("rect",{x:d.xscale(e.name),y:d.yscale(e.value),width:d.xscale.bandwidth(),height:d.chartHeight-d.yscale(e.value),fill:"#ccced0",key:e.name,class:Q(`info-${e.name}`),onMouseenter:t=>a.mouseEnterModelBar(e.name,t),onMouseleave:t=>a.mouseLeaveModelBar(e.name)},null,42,xa)))),128)),a.selectedmodel?(s(),l("line",{key:0,x1:"0",y1:d.hovery,x2:d.chartWidth,y2:d.hovery,stroke:"#333333","stroke-width":"1","stroke-dasharray":"5 2"},null,8,ka)):I("",!0),a.selectedmodel?(s(),l("text",{key:1,x:d.xscale(a.selectedmodel)+d.xscale.bandwidth()/2,y:d.hovery,dy:"-2","font-size":"10","text-anchor":"middle"},i(d.formatinfo(d.selectedbar)),9,Sa)):I("",!0)],8,wa)},ba.__scopeId="data-v-913460a4";const Ma={name:"StackedBar",props:["bardata","width","height","margin","colorscale","mouseEnterModelBar","mouseLeaveModelBar"],components:{Axis:Ie},data:()=>({yaxisformat:function(t){return e(".1s")(t)}}),computed:{chartWidth(){return this.width-this.margin.right-this.margin.left},chartHeight(){return this.height-this.margin.top-this.margin.bottom},xscale(){return y().domain(this.bardata.map((e=>e.name))).range([0,this.chartWidth]).padding(.25)},yscale(){const e=this.bardata.length>0?b(this.bardata[0].value.map((e=>e.yend))):0;return a().domain([0,e]).range([this.chartHeight,0])}}},_a=["transform"],ja=["transform","onMouseenter","onMouseleave"],Ba=["y","width","height","fill"];Ma.render=function(e,t,a,o,i,c){const d=w("Axis");return s(),l("g",{ref:"gRef",transform:`translate(${a.margin.left},${a.margin.top})`},[x(d,{orient:"bottom",scale:c.xscale,translateX:0,translateY:c.chartHeight,type:"category",rotatestyle:!0},null,8,["scale","translateY"]),x(d,{orient:"left",scale:c.yscale,translateX:0,translateY:0,format:i.yaxisformat},null,8,["scale","format"]),(s(!0),l(r,null,n(a.bardata,(e=>(s(),l("g",{transform:`translate(${c.xscale(e.name)},0)`,key:e.name,class:Q(`info-${e.name}`),onMouseenter:t=>a.mouseEnterModelBar(e.name,t),onMouseleave:t=>a.mouseLeaveModelBar(e.name)},[(s(!0),l(r,null,n(e.value,(e=>(s(),l("rect",{x:0,y:c.yscale(e.yend),width:c.xscale.bandwidth(),height:c.chartHeight-c.yscale(e.height),fill:a.colorscale(e.class),key:e.class},null,8,Ba)))),128))],42,ja)))),128))],8,_a)};const Fa=c({name:"SummaryBars",props:["predictions","statistics","selecteddata","colorscale"],components:{BarStatistics:ba,StackedBar:Ma},setup(e){const t=d(null),a=d(150),s=d(474),{resizeRef:l,resizeState:r}=sa(),n=V({top:20,right:5,bottom:35,left:24}),o=S((()=>e.statistics.map((e=>({name:e.name,value:e.accuracy}))).sort(((e,t)=>t.value-e.value)))),i=S((()=>e.statistics.map((e=>({name:e.name,value:e.precision}))).sort(((e,t)=>t.value-e.value)))),c=S((()=>e.statistics.map((e=>({name:e.name,value:e.recall}))).sort(((e,t)=>t.value-e.value)))),h=S((()=>e.statistics.map((e=>({name:e.name,value:e.f1}))).sort(((e,t)=>t.value-e.value)))),m=d(""),f=S((()=>{if(0===e.selecteddata.length)return p(e.predictions);{const t=[];return e.predictions.forEach((a=>{const s={name:a.name};s.value=e.selecteddata.map((e=>a.value[e])),t.push(s)})),p(t)}})),p=function(e){return e.map((e=>{const t={};e.value.forEach((e=>{t[e]=t[e]?t[e]+1:1}));const a=[];let s=0;return Object.entries(t).forEach((e=>{s+=e[1],a.push({class:e[0],height:e[1],yend:s})})),{name:e.name,value:a}}))};return G((()=>r.dimensions),((e,l)=>{if(e.width!==l.width||e.height!==l.height){const e=v(t.value),{width:l,height:n}=r.dimensions;e.attr("viewBox",[0,0,l,n]),s.value=n/5,a.value=l}})),u((()=>{const e=v(t.value),{width:l,height:n}=r.dimensions;e.attr("viewBox",[0,0,l,n]),s.value=n/5,a.value=l})),{svgRef:t,resizeRef:l,chartWidth:a,chartHeight:s,datacount:f,accuracy:o,precision:i,recall:c,f1:h,margin:n,mouseEnterModelBar:e=>{if("label"!==e){v(t.value).selectAll(`.info-${e}`).attr("stroke","#333333").attr("stroke-width","1"),m.value=e}},mouseLeaveModelBar:e=>{if("label"!==e){v(t.value).selectAll(`.info-${e}`).attr("stroke","none"),m.value=""}},selectedmodel:m}}}),Aa={ref:"resizeRef",id:"statisticsview"},Pa={ref:"svgRef"},Da=["transform"],Ra=["y"],za=["transform"],Ca=["y"],Ea=["transform"],Ia=["y"],Oa=["transform"],$a=["y"],Ha=["transform"],La=["y"];Fa.render=function(e,t,a,r,n,i){const c=w("StackedBar"),d=w("BarStatistics");return s(),l("div",Aa,[(s(),l("svg",Pa,[o("g",{transform:"translate(0,0)"},[o("text",{x:2,y:e.margin.top-10},"Data Count",8,Ra),x(c,{bardata:e.datacount,width:e.chartWidth,height:e.chartHeight,margin:e.margin,colorscale:e.colorscale,mouseEnterModelBar:e.mouseEnterModelBar,mouseLeaveModelBar:e.mouseLeaveModelBar},null,8,["bardata","width","height","margin","colorscale","mouseEnterModelBar","mouseLeaveModelBar"])],8,Da),o("g",{transform:"translate(0,"+e.chartHeight+")"},[o("text",{x:2,y:e.margin.top-10},"Accuracy",8,Ca),x(d,{bardata:e.accuracy,width:e.chartWidth,height:e.chartHeight,margin:e.margin,mouseEnterModelBar:e.mouseEnterModelBar,mouseLeaveModelBar:e.mouseLeaveModelBar,selectedmodel:e.selectedmodel},null,8,["bardata","width","height","margin","mouseEnterModelBar","mouseLeaveModelBar","selectedmodel"])],8,za),o("g",{transform:"translate(0,"+2*e.chartHeight+")"},[o("text",{x:2,y:e.margin.top-10},"Precision",8,Ia),x(d,{bardata:e.precision,width:e.chartWidth,height:e.chartHeight,margin:e.margin,mouseEnterModelBar:e.mouseEnterModelBar,mouseLeaveModelBar:e.mouseLeaveModelBar,selectedmodel:e.selectedmodel},null,8,["bardata","width","height","margin","mouseEnterModelBar","mouseLeaveModelBar","selectedmodel"])],8,Ea),o("g",{transform:"translate(0,"+3*e.chartHeight+")"},[o("text",{x:2,y:e.margin.top-10},"Recall",8,$a),x(d,{bardata:e.recall,width:e.chartWidth,height:e.chartHeight,margin:e.margin,mouseEnterModelBar:e.mouseEnterModelBar,mouseLeaveModelBar:e.mouseLeaveModelBar,selectedmodel:e.selectedmodel},null,8,["bardata","width","height","margin","mouseEnterModelBar","mouseLeaveModelBar","selectedmodel"])],8,Oa),o("g",{transform:"translate(0,"+4*e.chartHeight+")"},[o("text",{x:2,y:e.margin.top-10},"F1",8,La),x(d,{bardata:e.f1,width:e.chartWidth,height:e.chartHeight,margin:e.margin,mouseEnterModelBar:e.mouseEnterModelBar,mouseLeaveModelBar:e.mouseLeaveModelBar,selectedmodel:e.selectedmodel},null,8,["bardata","width","height","margin","mouseEnterModelBar","mouseLeaveModelBar","selectedmodel"])],8,Ha)],512))],512)},Fa.__scopeId="data-v-6855418a";const Wa={name:"PredictionCompView",components:{ParallelSet:ua,SummaryBars:Fa},data:()=>({width:1200,height:800,margin:{top:30,bottom:20,left:20,right:20}}),setup(){const e=M();return{loadingstatus:S((()=>e.state.predictionloading)),predictions:S((()=>e.state.predictions)),selectionfocus:S((()=>e.state.selectionfocus)),statistics:S((()=>e.state.statistics)),subsetstatistics:S((()=>e.state.subsetstatistics)),selecteddata:S((()=>e.state.selecteddata)),colorscale:S((()=>e.state.colorscale)),sortedmodelnames:S((()=>e.state.sortedmodelnames))}},methods:{}},Na={key:0,class:"loadingcontainer"},Ua={key:1,class:"container"},Va={id:"parallelsetcontainer"},Ta={id:"summarybarscontainer"};Wa.render=function(e,t,a,r,n,i){const c=w("a-spin"),d=w("ParallelSet"),u=w("SummaryBars");return r.loadingstatus?(s(),l("div",Na,[x(c,{tip:"Loading..."})])):(s(),l("div",Ua,[o("div",Va,[x(d,{predictions:r.predictions,selectionfocus:r.selectionfocus,sortedmodelnames:r.sortedmodelnames},null,8,["predictions","selectionfocus","sortedmodelnames"])]),o("div",Ta,[x(u,{predictions:r.predictions,statistics:0===r.selecteddata.length?r.statistics:r.subsetstatistics,width:150,selecteddata:r.selecteddata,colorscale:r.colorscale},null,8,["predictions","statistics","selecteddata","colorscale"])])]))},Wa.__scopeId="data-v-08810f31";var Ya=c({name:"VerticalBar",props:["featureshap","width","height","titleheight","shapsale","shapscale","yscale","colorscale","charttype","shapbarscale","modelname","sortMetric","getShapMetrc"],computed:{zerox:function(){return"barchart"===this.charttype?this.shapbarscale(0):this.shapscale(0)},prefercolor:function(){let e,t,a,s;const l=this.sortMetric,r=this.getShapMetrc;let n,o,i=0,c=0;return this.featureshap.shap.forEach(((d,u)=>{"avgabs"===l?(n=-d.sum[1],o=d.sum[0]):"extreme"===l?(n=d.min,o=d.max):n=o=r(d,l),0===u?(t=n,e=o,s=d.class,a=d.class,c=1,i=1):(e<o&&(e=o,a=d.class,c=1),t>n&&(t=n,s=d.class,i=1))})),"std"===l||"median"===l?["#999999","#999999"]:[i?this.colorscale(s):"#999999",c?this.colorscale(a):"#999999"]}},setup(e,t){const s=d(null);return u((()=>{h((()=>{e.featureshap.shap&&("boxplot"===e.charttype?(()=>{v(s.value).select("g.barchart").attr("visibility","hidden"),v(s.value).select("g.violinplot").attr("visibility","hidden"),v(s.value).select("g.boxplot").attr("visibility","visible");const t=e.yscale.bandwidth(),a=v(s.value).select("g.boxplot").selectAll("g.box").data(e.featureshap.shap,(e=>e.class)).join("g").attr("class","box").attr("transform",(t=>`translate(0,${e.yscale(t.class)})`));a.selectAll(".horizontalLine").data((e=>[[e.r0,e.r1]])).join("line").attr("class","horizontalLine").attr("stroke","#808080").attr("stroke-width","1px").attr("x1",(t=>e.shapscale(t[0]))).attr("x2",(t=>e.shapscale(t[1]))).attr("y1",t/2).attr("y2",t/2),a.selectAll("rect").data((e=>[e])).join("rect").attr("x",(t=>e.shapscale(t.q1))).attr("y",t/8).attr("width",(t=>e.shapscale(t.q3)-e.shapscale(t.q1))).attr("height",t/4*3).attr("fill",(t=>e.colorscale(t.class))).attr("fill-opacity",1).attr("stroke",(t=>e.colorscale(t.class))).attr("stroke-width",.4),a.selectAll(".verticalLine").data((e=>[e.r0,e.r1,e.median])).join("line").attr("class","verticalLine").attr("stroke","#808080").attr("stroke-width","1px").attr("x1",(t=>e.shapscale(t))).attr("x2",(t=>e.shapscale(t))).attr("y1",t/3).attr("y2",t/3*2),a.selectAll(".verticalLine0").data((e=>[e.median])).join("line").attr("class","verticalLine0").attr("stroke","#808080").attr("stroke-width","1px").attr("x1",(t=>e.shapscale(t))).attr("x2",(t=>e.shapscale(t))).attr("y1",t/8).attr("y2",t/8*7)})():"violinplot"===e.charttype?(()=>{v(s.value).select("g.barchart").attr("visibility","hidden"),v(s.value).select("g.boxplot").attr("visibility","hidden"),v(s.value).select("g.violinplot").attr("visibility","visible");const t=e.yscale.bandwidth();v(s.value).select("g.violinplot").selectAll("g.box").data(e.featureshap.shap,(e=>e.class)).join("g").attr("class","box").attr("transform",(t=>`translate(0,${e.yscale(t.class)})`)).selectAll(".violinline").data((e=>[e])).join("path").attr("class","violinline").attr("d",(s=>{const l=b(s.density_hist),r=a().range([0,t]).domain([-l,l]);return P().curve(D).x((t=>e.shapscale(t[0]))).y1((e=>r(e[1]))).y0((e=>r(-e[1])))((e=>{const t=e.density_hist.map(((t,a)=>[(e.bin_edges[a]+e.bin_edges[a+1])/2,t]));return t.unshift([e.bin_edges[0],0]),t.push([e.bin_edges[e.bin_edges.length-1],0]),t})(s))})).attr("fill",(t=>e.colorscale(t.class))).attr("fill-opacity",.5).attr("stroke",(t=>e.colorscale(t.class))).attr("stroke-opacity",1).attr("stroke-width",1).attr("stroke-linejoin","round")})():(()=>{v(s.value).select("g.boxplot").attr("visibility","hidden"),v(s.value).select("g.violinplot").attr("visibility","hidden"),v(s.value).select("g.barchart").attr("visibility","visible");const t=v(s.value).select("g.barchart"),{shapbarscale:a,sortMetric:l,getShapMetrc:r}=e;t.selectAll("rect").data(e.featureshap.shap,(e=>e.class)).join("rect").attr("x",(e=>"avgabs"===l?a(-e.sum[1]):"extreme"===l?e.min<0?a(e.min):a(0):a(Math.min(r(e,l),0)))).attr("y",(t=>e.yscale(t.class)+e.yscale.bandwidth()/8)).attr("width",(e=>"avgabs"===l?a(e.sum[0])-a(-e.sum[1]):"extreme"===l?e.min0>0?a(e.max)-a(0):e.max<0?a(0)-a(e.min):a(e.max)-a(e.min):Math.abs(a(r(e,l))-a(0)))).attr("height",e.yscale.bandwidth()/4*3).attr("fill",(t=>e.colorscale(t.class)))})())}))})),{barRef:s,hoveronfeature:e=>{t.emit("handleFeatureSelect",e)},clickonfeaturename:e=>{document.getElementById(`feature-${e}`).scrollIntoView()}}}});const Ga=["id"],Xa=(e=>(F("data-v-aadb36c0"),e=e(),A(),e))((()=>o("filter",{id:"shadow","color-interpolation-filters":"sRGB"},[o("feDropShadow",{dx:"0",dy:"0",stdDeviation:"3","flood-opacity":"0.5"})],-1))),qa=["width","height"],Ka=["width","height"],Ja=["transform"],Qa=["width","height","fill"],Za=["x","width","height","fill"],es=["transform"],ts=["x1","y1","x2","y2"],as=["transform"],ss=["transform"];Ya.render=function(e,t,a,r,n,c){return s(),l("g",{ref:"barRef",id:`shapfeature-${e.modelname}-${e.featureshap.feature}`},[Xa,o("rect",{x:"0",y:"0",width:e.width,height:e.height,fill:"#ffffff",stroke:"#efefef",class:Q(e.featureshap.feature+" featureborder"),visibility:"hidden",filter:"url(#shadow)"},null,10,qa),(s(),l("foreignObject",{x:"0",y:"0",width:e.width,height:e.titleheight},[o("div",{class:"featurename",onMouseover:t[0]||(t[0]=t=>e.hoveronfeature(e.featureshap.feature)),onMouseleave:t[1]||(t[1]=t=>e.hoveronfeature(e.featureshap.feature)),onClick:t[2]||(t[2]=t=>e.clickonfeaturename(e.featureshap.feature))},i(e.featureshap.feature),33)],8,Ka)),e.featureshap.shap?(s(),l("g",{key:0,transform:"translate(0,"+e.titleheight+")",opacity:"0.17"},[o("rect",{x:"0",y:"0",width:e.zerox,height:e.height-e.titleheight,fill:e.prefercolor[0],stroke:"none"},null,8,Qa),o("rect",{x:e.zerox,y:"0",width:e.width-e.zerox,height:e.height-e.titleheight,fill:e.prefercolor[1],stroke:"none"},null,8,Za)],8,Ja)):I("",!0),o("g",{transform:"translate(0,"+e.titleheight+")",class:"barchart"},null,8,es),o("line",{x1:e.zerox,y1:e.titleheight,x2:e.zerox,y2:e.height,stroke:"white"},null,8,ts),o("g",{transform:"translate(0,"+e.titleheight+")",class:"boxplot"},null,8,as),o("g",{transform:"translate(0,"+e.titleheight+")",class:"violinplot"},null,8,ss)],8,Ga)},Ya.__scopeId="data-v-aadb36c0";const ls={name:"VerticalBars",props:["shapvalue","width","colorscale","barchartheight","titleheight","layoutMethod","charttype","sortMetric","sortClass","shapscale","shapbarscale","normalizechecked","sortedfeaturenames","getShapMetrc"],components:{VerticalBar:Ya,SwapOutlined:Z,Axis:Ie},emits:["handleFeatureSelect","handleFeatureReorder"],computed:{orderedshap:function(){const e=this.getShapMetrc;return"FeatureName"!==this.layoutMethod?"all"===this.sortClass?this.shapvalue.values.sort(((t,a)=>b(a.shap.map((t=>e(t,this.sortMetric))))-b(t.shap.map((t=>e(t,this.sortMetric)))))):this.shapvalue.values.sort(((t,a)=>e(a.shap.find((e=>e.class===this.sortClass)),this.sortMetric)-e(t.shap.find((e=>e.class===this.sortClass)),this.sortMetric))):this.sortedfeaturenames.map((e=>{const t=this.shapvalue.values.find((t=>t.feature===e));return t||{feature:e,shap:null}}))},shapbarscaleown:function(){const e=Math.abs(b(this.shapvalue.values.flatMap((e=>e.shap)).flatMap((e=>Math.abs(this.getShapMetrc(e,this.sortMetric))))));return"std"===this.sortMetric?a().domain([0,e]).range([0,this.width]):a().domain([-e,e]).range([0,this.width])},shapscaleown:function(){const e=Math.abs(b(this.shapvalue.values.flatMap((e=>e.shap)).flatMap((e=>[Math.abs(e.max),Math.abs(e.min)]))));return a().domain([-e,e]).range([0,this.width])},yscale:function(){return y().domain(this.shapvalue.values[0].shap.map((e=>e.class))).range([0,this.barchartheight-this.titleheight]).padding(.2)}},methods:{handleFeatureSelect(e){this.$emit("handleFeatureSelect",e)}}},rs=["transform"];ls.render=function(e,t,a,o,i,c){const d=w("VerticalBar");return s(!0),l(r,null,n(c.orderedshap,((e,t)=>(s(),l("g",{key:a.shapvalue.model+e.feature,transform:"translate(0,"+a.barchartheight*t+")"},[x(d,{featureshap:e,width:a.width,height:a.barchartheight,titleheight:a.titleheight,shapscale:a.normalizechecked?a.shapscale:c.shapscaleown,yscale:c.yscale,shapbarscale:a.normalizechecked?a.shapbarscale:c.shapbarscaleown,colorscale:a.colorscale,onHandleFeatureSelect:c.handleFeatureSelect,charttype:a.charttype,modelname:a.shapvalue.model,sortMetric:a.sortMetric,getShapMetrc:a.getShapMetrc},null,8,["featureshap","width","height","titleheight","shapscale","yscale","shapbarscale","colorscale","onHandleFeatureSelect","charttype","modelname","sortMetric","getShapMetrc"])],8,rs)))),128)};const ns={name:"ShapBarName",components:{Axis:Ie,SwapOutlined:Z},data:()=>({axisformat:t=>t<.001&&t>-.001&&0!==t?e(".1e")(t):e(".2")(t)}),props:["shapvalue","normalizechecked","layoutMethod","titleheight","selectedmodelname","width","shapscale","charttype","shapbarscale","sortMetric","getShapMetrc"],emits:["handleFeatureReorder"],computed:{shapscaleown:function(){const e=Math.abs(b(this.shapvalue.values.flatMap((e=>e.shap)).flatMap((e=>[Math.abs(e.max),Math.abs(e.min)]))));return a().domain([-e,e]).range([0,this.width])},shapbarscaleown:function(){const e=Math.abs(b(this.shapvalue.values.flatMap((e=>e.shap)).flatMap((e=>Math.abs(this.getShapMetrc(e,this.sortMetric))))));return"std"===this.sortMetric?a().domain([0,e]).range([0,this.width]):a().domain([-e,e]).range([0,this.width])},axisscale:function(){return"boxplot"===this.charttype||"violinplot"===this.charttype?this.normalizechecked?this.shapscale:this.shapscaleown:this.normalizechecked?this.shapbarscale:this.shapbarscaleown}},methods:{clickonmodelname(e){"FeatureName"===this.layoutMethod&&this.$emit("handleFeatureReorder",e)}}},os=["width","height"],is=["title"],cs=["transform"];ns.render=function(e,t,a,n,c,d){const u=w("SwapOutlined"),h=w("Axis");return s(),l(r,null,[(s(),l("foreignObject",{x:"0",y:"0",width:a.width,height:a.titleheight},[o("div",{class:"modelname",title:a.shapvalue.model,onClick:t[0]||(t[0]=e=>d.clickonmodelname(a.shapvalue.model)),style:ee(a.selectedmodelname===a.shapvalue.model&&"FeatureName"===a.layoutMethod?{color:"#08c"}:{})},[o("div",{style:ee("FeatureName"===a.layoutMethod?{cursor:"pointer"}:{})},[B(i(a.shapvalue.model)+" ",1),te(x(u,{rotate:90},null,512),[[ae,"FeatureName"===a.layoutMethod]])],4)],12,is)],8,os)),o("g",{transform:"translate(0,"+a.titleheight+")"},[x(h,{orient:"bottom",scale:d.axisscale,translateX:0,translateY:0,format:c.axisformat},null,8,["scale","format"])],8,cs)],64)},ns.__scopeId="data-v-efa7f316";var ds=c({name:"ShapBars",props:["shapvalues","colorscale","sortedmodelnames"],components:{VerticalBars:ls,ShapBarName:ns,PlusCircleFilled:se},setup(e){const t=d(null),s=d(null),l=d(80),r=d(20),{resizeRef:n,resizeState:o}=sa(),i=50,c=3,m=d(),f=d("Contribution"),p=d(e.shapvalues[0].model),g=d(!1),w=S((()=>F(p.value))),x=d("avgabs"),k=d("all"),_=M(),j=S((()=>_.state.classes)),B=(e,t)=>"avgabs"===t?b(e.sum):"avg"===t?e.avg:"extreme"===t?b([e.max,-e.min]):"median"===t?e.median:e.std,F=t=>{let a=((e,t,a)=>{let s=JSON.parse(JSON.stringify(e));return"all"===a?s.sort(((e,a)=>b(a.shap.map((e=>B(e,t))))-b(e.shap.map((e=>B(e,t)))))).map((e=>e.feature)):s.sort(((e,s)=>B(s.shap.find((e=>e.class===a)),t)-B(e.shap.find((e=>e.class===a)),t))).map((e=>e.feature))})(e.shapvalues.find((e=>e.model===t)).values,x.value,k.value);return a.push(...A.value.filter((e=>!a.includes(e)))),a},A=S((()=>{let t={};return e.shapvalues.forEach((e=>{e.values.forEach((e=>{e.feature in t?t[e.feature]++:t[e.feature]=1}))})),Object.keys(t)})),P=S((()=>{const{width:e,height:t}=o.dimensions;return e-i-c})),D=S((()=>{let t=b(e.shapvalues.map((e=>e.values.length)));return t=b([0,t]),"FeatureName"===f.value&&(t=A.value.length),r.value+l.value*t})),R=S((()=>y().domain(e.sortedmodelnames).range([i,P.value?P.value:100]).padding(.1)));u((()=>{const e=v(t.value),a=v(s.value);h((()=>{e.attr("viewBox",[0,0,P.value,D.value]),a.attr("viewBox",[0,0,P.value,80])}))}));const z=S((()=>{const t=Math.abs(b(e.shapvalues.flatMap((e=>e.values)).flatMap((e=>e.shap)).flatMap((e=>[Math.abs(e.max),Math.abs(e.min)]))));return a().domain([-t,t]).range([0,R.value.bandwidth()])})),C=S((()=>{const t=Math.abs(b(e.shapvalues.flatMap((e=>e.values)).flatMap((e=>e.shap)).flatMap((e=>Math.abs(B(e,x.value))))));return a().domain([-t,t]).range([0,R.value.bandwidth()])}));G((()=>o.dimensions),((e,a)=>{const l=v(t.value),r=v(s.value);e.width===a.width&&e.height===a.height||(l.attr("viewBox",[0,0,P.value,D.value]),r.attr("viewBox",[0,0,P.value,80]))}));return{svgRef:t,headersvgRef:s,resizeRef:n,xscale:R,barchartheight:l,titleheight:r,handlefeatureselect:e=>{v(t.value).selectAll(".featureborder").attr("visibility","hidden"),m.value!==e?(v(t.value).selectAll(`.${e}`).attr("visibility","visible"),m.value=e):m.value=""},layoutMethod:f,charttype:d("violinplot"),shapscale:z,chartwidth:P,shapbarscale:C,updatesortedfeaturenames:e=>{p.value=e},sortedfeaturenames:w,selectedModelName:p,normalizechecked:g,sortMetric:x,classPrefer:k,classes:j,getShapMetrc:B}}});const us={id:"shapview"},hs={class:"header"},ms=B(" Layout: "),fs=B("Aligned"),ps=B("Compact"),gs=B(" SortBy: "),vs=B("Average"),ys=B("Extreme"),bs=B("Median"),ws=B("Std Dev"),xs=B(" "),ks=B(" "),Ss=B("All"),Ms=B(" Chart Type: "),_s=B("BoxPlot"),js=B("ViolinPlot"),Bs=B("BarChart"),Fs=B(" Normalization: "),As={id:"modelheadersvg"},Ps={ref:"headersvgRef"},Ds=["transform"],Rs={id:"interpretationsvg",ref:"resizeRef"},zs={ref:"svgRef"},Cs=["transform"];ds.render=function(e,t,a,c,d,u){const h=w("a-select-option"),m=w("a-select"),f=w("a-select-opt-group"),p=w("PlusCircleFilled"),g=w("a-switch"),v=w("ShapBarName"),y=w("VerticalBars");return s(),l("div",us,[o("div",hs,[o("span",null,[ms,x(m,{value:e.layoutMethod,"onUpdate:value":t[0]||(t[0]=t=>e.layoutMethod=t),style:{width:"100px"},size:"small"},{default:_((()=>[x(h,{value:"FeatureName"},{default:_((()=>[fs])),_:1}),x(h,{value:"Contribution"},{default:_((()=>[ps])),_:1})])),_:1},8,["value"])]),o("span",null,[gs,x(m,{value:e.sortMetric,"onUpdate:value":t[1]||(t[1]=t=>e.sortMetric=t),style:{width:"100px"},size:"small"},{default:_((()=>[x(f,{label:"Metric"},{default:_((()=>[x(h,{value:"avgabs"},{default:_((()=>[vs])),_:1}),x(h,{value:"extreme"},{default:_((()=>[ys])),_:1}),x(h,{value:"median"},{default:_((()=>[bs])),_:1}),x(h,{value:"std"},{default:_((()=>[ws])),_:1})])),_:1})])),_:1},8,["value"]),xs,x(p),ks,x(m,{value:e.classPrefer,"onUpdate:value":t[2]||(t[2]=t=>e.classPrefer=t),style:{width:"100px"},size:"small"},{default:_((()=>[x(f,{label:"Class Preference"},{default:_((()=>[x(h,{value:"all"},{default:_((()=>[Ss])),_:1}),(s(!0),l(r,null,n(e.classes,(e=>(s(),j(h,{value:e,key:e},{default:_((()=>[B(i(e),1)])),_:2},1032,["value"])))),128))])),_:1})])),_:1},8,["value"])]),o("span",null,[Ms,x(m,{value:e.charttype,"onUpdate:value":t[3]||(t[3]=t=>e.charttype=t),style:{width:"100px"},size:"small"},{default:_((()=>[x(h,{value:"boxplot"},{default:_((()=>[_s])),_:1}),x(h,{value:"violinplot"},{default:_((()=>[js])),_:1}),x(h,{value:"barchart"},{default:_((()=>[Bs])),_:1})])),_:1},8,["value"])]),o("span",null,[Fs,x(g,{checked:e.normalizechecked,"onUpdate:checked":t[4]||(t[4]=t=>e.normalizechecked=t),size:"small"},null,8,["checked"])])]),o("div",As,[(s(),l("svg",Ps,[(s(!0),l(r,null,n(e.shapvalues,(t=>(s(),l("g",{transform:"translate("+e.xscale(t.model)+",0)",key:t.model},[x(v,{shapvalue:t,width:e.xscale.bandwidth(),shapscale:e.shapscale,titleheight:e.titleheight,shapbarscale:e.shapbarscale,normalizechecked:e.normalizechecked,charttype:e.charttype,layoutMethod:e.layoutMethod,selectedmodelname:e.selectedModelName,sortMetric:e.sortMetric,getShapMetrc:e.getShapMetrc,onHandleFeatureReorder:e.updatesortedfeaturenames},null,8,["shapvalue","width","shapscale","titleheight","shapbarscale","normalizechecked","charttype","layoutMethod","selectedmodelname","sortMetric","getShapMetrc","onHandleFeatureReorder"])],8,Ds)))),128))],512))]),o("div",Rs,[(s(),l("svg",zs,[(s(!0),l(r,null,n(e.shapvalues,(t=>(s(),l("g",{transform:"translate("+e.xscale(t.model)+",0)",key:t.model},[x(y,{shapvalue:t,width:e.xscale.bandwidth(),normalizechecked:e.normalizechecked,shapscale:e.shapscale,shapbarscale:e.shapbarscale,colorscale:e.colorscale,barchartheight:e.barchartheight,titleheight:e.titleheight,layoutMethod:e.layoutMethod,charttype:e.charttype,sortMetric:e.sortMetric,sortClass:e.classPrefer,getShapMetrc:e.getShapMetrc,onHandleFeatureSelect:e.handlefeatureselect,onHandleFeatureReorder:e.updatesortedfeaturenames,sortedfeaturenames:e.sortedfeaturenames},null,8,["shapvalue","width","normalizechecked","shapscale","shapbarscale","colorscale","barchartheight","titleheight","layoutMethod","charttype","sortMetric","sortClass","getShapMetrc","onHandleFeatureSelect","onHandleFeatureReorder","sortedfeaturenames"])],8,Cs)))),128))],512))],512)])},ds.__scopeId="data-v-3d5dd916";var Es=c({name:"InterpretationView",components:{ShapBars:ds},setup(){const e=M();return{shapvalues:S((()=>e.state.subsetshap)),colorscale:S((()=>e.state.colorscale)),loadingstatus:S((()=>e.state.shapviewloading)),sortedmodelnames:S((()=>e.state.sortedmodelnames.filter((e=>"label"!==e))))}}});const Is={key:0,class:"loadingcontainer"},Os={key:1};Es.render=function(e,t,a,r,n,o){const i=w("a-spin"),c=w("ShapBars");return e.loadingstatus?(s(),l("div",Is,[x(i,{tip:"Loading..."})])):(s(),l("div",Os,[x(c,{shapvalues:e.shapvalues,colorscale:e.colorscale,sortedmodelnames:e.sortedmodelnames},null,8,["shapvalues","colorscale","sortedmodelnames"])]))},Es.__scopeId="data-v-e771f498";var $s=c({name:"SubsetContainer",components:{CheckOutlined:le,EditOutlined:re},setup(){const e=d([]),t=S((()=>e.value.length+1)),a=V({}),s=M(),l=S((()=>s.state.selecteddata));return{columns:[{title:"name",dataIndex:"name",width:"40%",slots:{customRender:"name"}},{title:"amount",dataIndex:"amount"},{title:"operation",dataIndex:"operation",slots:{customRender:"operation"}}],onDelete:t=>{e.value=e.value.filter((e=>e.key!==t))},handleAdd:a=>{if(0===l.value.length)ne.open({message:"No data is selected!",icon:oe(ie,{style:"color: #faad14"}),placement:"bottomLeft",duration:1.5});else{const s={key:`${t.value}`,name:a,amount:l.value.length,values:l.value};e.value.push(s)}},dataSource:e,editableData:a,count:t,edit:t=>{a[t]=U.cloneDeep(e.value.filter((e=>t===e.key))[0])},save:t=>{Object.assign(e.value.filter((e=>t===e.key))[0],a[t]),delete a[t]},customRow:e=>({onClick:()=>{v("#subsettable").selectAll("tr").style("background","none"),v("#subsettable").selectAll(`tr[data-row-key='${e.key}']`).style("background","#e6f7ff"),s.commit("updateSelectedData",e.values)}})}}});const Hs={class:"container"},Ls={id:"subsettable"},Ws={class:"editable-cell"},Ns={key:0,class:"editable-cell-input-wrapper"},Us={key:1,class:"editable-cell-text-wrapper"},Vs=(e=>(F("data-v-627cfe6e"),e=e(),A(),e))((()=>o("a",null,"Delete",-1)));$s.render=function(e,t,a,r,n,c){const d=w("a-input-search"),u=w("a-input"),h=w("check-outlined"),m=w("edit-outlined"),f=w("a-popconfirm"),p=w("a-table");return s(),l("div",Hs,[x(d,{placeholder:"input subset name",size:"small",onSearch:e.handleAdd,"enter-button":"Add"},null,8,["onSearch"]),o("div",Ls,[x(p,{bordered:"","data-source":e.dataSource,size:"small",columns:e.columns,"custom-row":e.customRow,scroll:{y:!0}},{name:_((({text:t,record:a})=>[o("div",Ws,[e.editableData[a.key]?(s(),l("div",Ns,[x(u,{value:e.editableData[a.key].name,"onUpdate:value":t=>e.editableData[a.key].name=t,onPressEnter:t=>e.save(a.key)},null,8,["value","onUpdate:value","onPressEnter"]),x(h,{class:"editable-cell-icon-check",onClick:t=>e.save(a.key)},null,8,["onClick"])])):(s(),l("div",Us,[B(i(t||" ")+" ",1),x(m,{class:"editable-cell-icon",onClick:t=>e.edit(a.key)},null,8,["onClick"])]))])])),operation:_((({record:t})=>[e.dataSource.length?(s(),j(f,{key:0,title:"Sure to delete?",onConfirm:a=>e.onDelete(t.key)},{default:_((()=>[Vs])),_:2},1032,["onConfirm"])):I("",!0)])),_:1},8,["data-source","columns","custom-row"])])])},$s.__scopeId="data-v-627cfe6e";var Ts=c({name:"FeatureSelection",setup(){const e=d("tsne_all"),t=M();return{value:S({get:()=>t.state.selectedfeatures,set:e=>{t.commit("updateSelectedFeatures",e)}}),featurenames:S((()=>t.state.featurenames)),calProjection:()=>{t.dispatch("getProjectionResult",e.value)},clearFeatures:()=>{t.commit("updateSelectedFeatures",[])},selectAll:()=>{t.commit("updateSelectedFeatures",t.state.featurenames)},projectionmethod:e,changeprojectionmethod:()=>{t.commit("changeProjectionMethod",e.value)}}}});const Ys={class:"featureselection"},Gs=B("TSNE(num)"),Xs=B("TSNE(cat)"),qs=B("TSNE(all)"),Ks=B("SelectAll"),Js=B("Clear"),Qs=B("Project");Ts.render=function(e,t,a,c,d,u){const h=w("a-radio"),m=w("a-radio-group"),f=w("a-select-option"),p=w("a-select"),g=w("a-button");return s(),l("div",Ys,[o("div",null,[x(m,{value:e.projectionmethod,"onUpdate:value":t[0]||(t[0]=t=>e.projectionmethod=t),onChange:e.changeprojectionmethod},{default:_((()=>[x(h,{value:"tsne_num"},{default:_((()=>[Gs])),_:1}),x(h,{value:"tsne_categorical"},{default:_((()=>[Xs])),_:1}),x(h,{value:"tsne_all"},{default:_((()=>[qs])),_:1})])),_:1},8,["value","onChange"])]),x(p,{mode:"multiple",value:e.value,"onUpdate:value":t[1]||(t[1]=t=>e.value=t),style:{width:"100%",height:"45px"},size:"small",placeholder:"Please select"},{default:_((()=>[(s(!0),l(r,null,n(e.featurenames,(e=>(s(),j(f,{key:e},{default:_((()=>[B(i(e),1)])),_:2},1024)))),128))])),_:1},8,["value"]),x(g,{size:"small",onClick:e.selectAll},{default:_((()=>[Ks])),_:1},8,["onClick"]),x(g,{size:"small",onClick:e.clearFeatures},{default:_((()=>[Js])),_:1},8,["onClick"]),x(g,{size:"small",onClick:e.calProjection,id:"projectbutton"},{default:_((()=>[Qs])),_:1},8,["onClick"])])},Ts.__scopeId="data-v-6d981be0";var Zs={name:"Projection",props:["data"],setup(e){const s=d(null),l=d(null),r=d(null),n=M(),o=n.state.colorscale,i=S((()=>n.state.encodingfeature)),{resizeRef:c,resizeState:u}=sa(),h=a(),m=a();let f,p,g;const y=ce().on("end",(({sourceEvent:t,selection:a})=>{if(!t)return;let s=[];if(a){const[[t,l],[r,n]]=a;s=e.data.filter((e=>h(e.pos[0])>t&&h(e.pos[0])<r&&m(e.pos[1])>l&&m(e.pos[1])<n)).map((e=>e.id))}n.commit("changeSelectionFocus","projection"),n.commit("updateSelectedData",s)})),b=S((()=>new Map(e.data.map(((e,t)=>[e.id,t]))))),w=(e,a,s,l)=>{let n=o;const i=v(r.value).select(".legend");if(i.selectAll("*").remove(),"numerical"===a.type){const e=t(a.value);n=de().domain(e).interpolator(ue),Kt({svg:i,color:de(e,ue),title:a.name})}else if("categorical"===a.type){const e=[...new Set(a.value)];n=he().domain(e).range(me),Kt({svg:i,color:he(e,me),title:a.name})}f.clearRect(0,0,s,l),g=qt((e=>{f.fillStyle=n(a.value[e.id]),f.beginPath(),f.arc(h(e.pos[0]),m(e.pos[1]),3.5,0,2*Math.PI),f.closePath(),f.fill(),f.stroke()})),g(e)},x=t=>{v(r.value).select(".brush").call(y.move,null);const{width:a,height:s}=u.dimensions,l=t.map((t=>e.data[b.value.get(t)]));p.clearRect(0,0,a,s),p.strokeStyle="black",l.forEach((e=>{p.beginPath(),p.arc(h(e.pos[0]),m(e.pos[1]),3.5,0,2*Math.PI),p.stroke()}))},k=a=>{const{width:o,height:c}=a,d=v(r.value),u=v(s.value),g=v(l.value);y.extent([[0,0],[o,c]]),((e,t,a,s)=>{e.attr("width",a).attr("height",s),f=e.node().getContext("2d"),f.globalCompositeOperation="color",f.globalAlpha=.6,f.lineWidth=1,t.attr("width",a).attr("height",s),p=t.node().getContext("2d"),p.globalAlpha=.6,p.lineWidth=1})(u,g,o,c),h.domain(t(e.data.map((e=>e.pos[0])))).range([5,o-5]),m.domain(t(e.data.map((e=>e.pos[1])))).range([c-5,5]),((e,t,a)=>{e.attr("viewBox",[0,0,t,a]),e.select(".brush").remove(),e.append("g").attr("class","brush").call(y)})(d,o,c),w(e.data,i.value,o,c),x(n.state.selecteddata)};return G((()=>n.state.selecteddata),(e=>{x(e)}),{deep:!0}),G((()=>u.dimensions),(e=>{k(e)})),G(i,((t,a)=>{const l=v(s.value);w(e.data,t,l.node().width,l.node().height),x(n.state.selecteddata)})),{resizeRef:c,canvasRef:s,upperCanvasRef:l,svgRef:r,changecolor:()=>{f.fillStyle="black"},legend:Kt,scaleSequential:de,interpolateYlGnBu:ue}}};const el=e=>(F("data-v-0fa971a4"),e=e(),A(),e),tl={id:"projectioncanvas",ref:"resizeRef"},al={ref:"canvasRef"},sl={ref:"upperCanvasRef"},ll={ref:"svgRef"},rl=[el((()=>o("g",{class:"brush"},null,-1))),el((()=>o("g",{class:"legend"},null,-1)))];Zs.render=function(e,t,a,r,n,i){return s(),l("div",tl,[o("canvas",al,null,512),o("canvas",sl,null,512),(s(),l("svg",ll,rl,512))],512)},Zs.__scopeId="data-v-0fa971a4";var nl=c({name:"FeatureView",components:{Projection:Zs},setup(){const e=M();return{data:S((()=>e.state.projectionresults)),loadingstatus:S((()=>e.state.projectionloading))}}});const ol={key:0,class:"loadingcontainer"},il={key:1};nl.render=function(e,t,a,r,n,o){const i=w("a-spin"),c=w("Projection");return e.loadingstatus?(s(),l("div",ol,[x(i,{tip:"Loading..."})])):(s(),l("div",il,[x(c,{data:e.data.data},null,8,["data"])]))},nl.__scopeId="data-v-5bae6426";const cl={name:"ShapProj",props:["data"],setup(e){const s=d(null),l=d(null),r=d(null),n=M(),o=n.state.colorscale,i=S((()=>n.state.encodingfeature)),{resizeRef:c,resizeState:h}=sa(),m=a(),f=a();let p,g,y;const b=ce().on("end",(({sourceEvent:t,selection:a})=>{if(!t)return;let s=[];if(a){const[[t,l],[r,n]]=a;s=e.data.filter((e=>m(e.pos[0])>t&&m(e.pos[0])<r&&f(e.pos[1])>l&&f(e.pos[1])<n)).map((e=>e.id))}n.commit("changeSelectionFocus","projection"),n.commit("updateSelectedData",s)})),w=S((()=>new Map(e.data.map(((e,t)=>[e.id,t]))))),x=(e,a,s,l)=>{let n=o;const i=v(r.value).select(".legend");if(i.selectAll("*").remove(),"numerical"===a.type){const e=t(a.value);n=de().domain(e).interpolator(ue),Kt({svg:i,color:de(e,ue),title:a.name})}else if("categorical"===a.type){const e=[...new Set(a.value)];n=he().domain(e).range(fe),Kt({svg:i,color:he(e,fe),title:a.name})}p.clearRect(0,0,s,l),y=qt((e=>{p.fillStyle=n(a.value[e.id]),p.beginPath(),p.arc(m(e.pos[0]),f(e.pos[1]),3.5,0,2*Math.PI),p.closePath(),p.fill()})),y(e)},k=t=>{v(r.value).select(".brush").call(b.move,null);const{width:a,height:s}=h.dimensions,l=t.map((t=>e.data[w.value.get(t)]));g.clearRect(0,0,a,s),g.strokeStyle="black",l.forEach((e=>{g.beginPath(),g.arc(m(e.pos[0]),f(e.pos[1]),3.5,0,2*Math.PI),g.stroke()}))},_=a=>{const{width:o,height:c}=a,d=v(r.value),u=v(s.value),h=v(l.value);b.extent([[0,0],[o,c]]),((e,t,a,s)=>{e.attr("width",a).attr("height",s),p=e.node().getContext("2d"),p.globalCompositeOperation="color",p.globalAlpha=.6,p.lineWidth=1,t.attr("width",a).attr("height",s),g=t.node().getContext("2d"),g.globalAlpha=.6,g.lineWidth=1})(u,h,o,c),m.domain(t(e.data.map((e=>e.pos[0])))).range([5,o-5]),f.domain(t(e.data.map((e=>e.pos[1])))).range([c-5,5]),((e,t,a)=>{e.attr("viewBox",[0,0,t,a]),e.select(".brush").remove(),e.append("g").attr("class","brush").call(b)})(d,o,c),x(e.data,i.value,o,c),k(n.state.selecteddata)};return u((()=>{_(h.dimensions)})),G((()=>e.data),(()=>{_(h.dimensions)})),G((()=>n.state.selecteddata),(e=>{k(e)}),{deep:!0}),G((()=>h.dimensions),(e=>{_(e)})),G(i,((t,a)=>{const l=v(s.value);x(e.data,t,l.node().width,l.node().height),k(n.state.selecteddata)})),{resizeRef:c,canvasRef:s,upperCanvasRef:l,svgRef:r,changecolor:()=>{p.fillStyle="black"},legend:Kt,scaleSequential:de,interpolateYlGnBu:ue}}},dl=e=>(F("data-v-d982f7e8"),e=e(),A(),e),ul={id:"shapprojectioncanvas",ref:"resizeRef"},hl={ref:"canvasRef"},ml={ref:"upperCanvasRef"},fl={ref:"svgRef"},pl=[dl((()=>o("g",{class:"brush"},null,-1))),dl((()=>o("g",{class:"legend"},null,-1)))];cl.render=function(e,t,a,r,n,i){return s(),l("div",ul,[o("canvas",hl,null,512),o("canvas",ml,null,512),(s(),l("svg",fl,pl,512))],512)},cl.__scopeId="data-v-d982f7e8";const gl={name:"InterpretationProj",components:{ShapProj:cl},setup(e){const t=M(),a=d(),s=S((()=>t.state.models)),l=S((()=>t.state.shapprojection)),r=S((()=>t.state.shapprojectionloading));return G(s,(()=>{a.value=s.value[0],t.commit("changeTargetModel",s.value[0])})),{models:s,selectedmodel:a,handleSelectModel:e=>{t.dispatch("getShapProjectionResult",e)},loadingstatus:r,projdata:l}}},vl={style:{width:"100%",height:"480px",position:"relative"}},yl={style:{position:"absolute","padding-left":"5px"}},bl=B(" Model: "),wl=B(" all "),xl={style:{width:"100%",height:"100%",position:"relative",top:"27px"}},kl={key:0,class:"loadingcontainer projcontainer"},Sl={key:1,class:"projcontainer"};gl.render=function(e,t,a,c,d,u){const h=w("a-select-option"),m=w("a-select"),f=w("a-spin"),p=w("ShapProj");return s(),l("div",vl,[o("div",yl,[bl,x(m,{value:c.selectedmodel,"onUpdate:value":t[0]||(t[0]=e=>c.selectedmodel=e),size:"small",placeholder:"Please select",onSelect:c.handleSelectModel,style:{width:"120px"}},{default:_((()=>[x(h,{value:"all"},{default:_((()=>[wl])),_:1}),(s(!0),l(r,null,n(c.models,(e=>(s(),j(h,{key:e,value:e},{default:_((()=>[B(i(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","onSelect"])]),o("div",xl,[c.loadingstatus?(s(),l("div",kl,[x(f,{tip:"Loading..."})])):(s(),l("div",Sl,[c.projdata.length>0?(s(),j(p,{key:0,data:c.projdata},null,8,["data"])):I("",!0)]))])])},gl.__scopeId="data-v-12d94510";const Ml={name:"ProjectionContainer",components:{FeatureSelection:Ts,FeatureView:nl,InterpretationProj:gl},setup:()=>({activeKey:d("1")})},_l={class:"panelcontent"},jl={class:"panelcontent projectionview"};Ml.render=function(e,t,a,l,r,n){const i=w("InterpretationProj"),c=w("a-tab-pane"),d=w("FeatureSelection"),u=w("FeatureView"),h=w("a-tabs");return s(),j(h,{activeKey:l.activeKey,"onUpdate:activeKey":t[0]||(t[0]=e=>l.activeKey=e),size:"small"},{default:_((()=>[x(c,{key:"1",tab:"Explanation","force-render":""},{default:_((()=>[o("div",_l,[x(i)])])),_:1}),x(c,{key:"2",tab:"Feature"},{default:_((()=>[x(d),o("div",jl,[x(u)])])),_:1})])),_:1},8,["activeKey"])},Ml.__scopeId="data-v-2ff7e78c";const Bl={name:"Interface",components:{Overview:qe,FeatureDistribution:It,PredictionCompView:Wa,InterpretationView:Es,SubsetContainer:$s,ProjectionContainer:Ml}},Fl={class:"main"},Al={class:"firstcol col"},Pl={class:"overviewpanel panel"},Dl=o("div",{class:"headline"}," Overview ",-1),Rl={class:"panelcontent"},zl={class:"subsetspanel panel"},Cl=o("div",{class:"headline"}," Subsets ",-1),El={class:"panelcontent"},Il={class:"secondcol col"},Ol={class:"featureviewpanel panel"},$l=o("div",{class:"headline"}," Projection View ",-1),Hl={class:"panelcontent"},Ll={class:"featureselpanel panel"},Wl=o("div",{class:"headline"}," Feature View ",-1),Nl={class:"panelcontent distributionview"},Ul={class:"thirdcol col"},Vl={class:"modelresultspanel panel"},Tl=o("div",{class:"headline"}," Classification View ",-1),Yl={class:"panelcontent predictionview"},Gl={class:"featureinterprepanel panel"},Xl=o("div",{class:"headline"}," Explanation View ",-1),ql={class:"panelcontent"};Bl.render=function(e,t,a,r,n,i){const c=w("Overview"),d=w("SubsetContainer"),u=w("ProjectionContainer"),h=w("FeatureDistribution"),m=w("PredictionCompView"),f=w("InterpretationView");return s(),l("div",Fl,[o("div",Al,[o("div",Pl,[Dl,o("div",Rl,[x(c)])]),o("div",zl,[Cl,o("div",El,[x(d)])])]),o("div",Il,[o("div",Ol,[$l,o("div",Hl,[x(u)])]),o("div",Ll,[Wl,o("div",Nl,[x(h)])])]),o("div",Ul,[o("div",Vl,[Tl,o("div",Yl,[x(m)])]),o("div",Gl,[Xl,o("div",ql,[x(f)])])])])};const Kl={name:"App",components:{Interface:Bl},mounted(){this.$store.dispatch("initdatasetlist"),this.$store.dispatch("changeDataset",this.$store.state.dataset),this.$store.watch((e=>e.selecteddata),(e=>{e.length>0?this.$store.dispatch("getSubsetInfo",e):(this.$store.commit("updateSubsetFeatureInfo",[]),this.$store.commit("updateSubsetShap",this.$store.state.shapvalues))}))}};Kl.render=function(e,t,a,l,r,n){const o=w("Interface");return s(),j(o)};var Jl=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",featuredistribution:e=>{const t=e.subsetfeatureinfo,a=U.cloneDeep(e.featureinfo),s=[];return a.forEach(((e,a)=>{let l=[];t.length&&(l=U.cloneDeep(t.find((t=>t.feature===e.feature)).data)),e.subset=l,s.push(e)})),s},selecteddataid:e=>e.selecteddata,featureusestate:e=>{const t=e.featurenames,a=e.featureuse,s={},l=a.map((e=>e.name)),r=l.length;t.forEach((e=>{s[e]=new Array(r).fill(0)})),a.forEach(((e,t)=>{e.features.forEach((e=>{s[e][t]=1}))}));const n=[];return t.forEach((e=>{const t={};t.feature=e,t.modeluse=l.map(((t,a)=>[t,s[e][a]])),n.push(t)})),n}});const Ql=pe.create({baseURL:`${window.location.href}/api`}),Zl=e=>Ql.get(`/${e}/featureinfo`),er=(e,t)=>Ql.post(`/${e}/featureinfo/subset`,{subset:t}),tr=(e,t,a)=>Ql.post(`/${e}/shap/subset`,{models:t,subset:a}).catch((e=>{})),ar=(e,t,a)=>Ql.post(`/${e}/statistics/subset`,{models:t,subset:a}),sr=(e,t,a)=>Ql.post(`/${e}/calFeatureProjection/${a}`,{features:t}),lr=e=>Ql.get(`/${e}/modelinfos`),rr=(e,t)=>Ql.get(`/${e}/shapproj/${t}`);var nr=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",initdatasetlist:async({commit:e})=>{const t=await Ql.get("/datasetlist");e("setDatasetList",await t.data)},changeDataset:async({commit:e,state:t},a)=>{e("updateSubsetFeatureInfo",[]),e("changeDataset",a),e("changeDistributionloading",!0),e("changePredictionloading",!0),e("changeShapviewloading",!0),e("changeProjectionloading1",!0),e("changeProjectionloading2",!0);const s=await(l=a,pe.all([Zl(l),lr(l)]));var l;e("updateSelectedData",[]),e("updateFeatureInfo",await s[0].data),e("updateModelInfos",await s[1].data),e("changeidmap",await s[1].data.dataids),e("updatemodelnames",await s[1].data.modelnames),e("initialmodelnames",await s[1].data.selectedmodelnames),e("updatemodelmetrics",await s[1].data.modelinfos),e("updateSelectedFeatures",await s[0].data.featureinfo.filter((e=>"class"!==e.ftype)).map((e=>e.feature))),e("changeDistributionloading",!1),e("changePredictionloading",!1),e("changeShapviewloading",!1);const r=await rr(t.dataset,s[1].data.modelnames[0]);e("updateShapProjection",await r.data),e("changeProjectionloading1",!1);const n=await sr(a,"all",t.projectionmethod);e("updateProjection",await n.data),e("changeProjectionloading2",!1)},changeModels:async({commit:e,state:t},a)=>{e("changePredictionloading",!0),e("changeShapviewloading",!0);const s=await((e,t)=>Ql.post(`/${e}/selectedmodelinfos`,{models:t}))(t.dataset,a);e("updateModelInfos",await s.data),e("changePredictionloading",!1),e("changeShapviewloading",!1)},getProjectionResult:async({commit:e,state:t},a)=>{e("changeProjectionloading2",!0);const s=await sr(t.dataset,t.selectedfeatures,a);e("updateProjection",await s.data),e("changeProjectionloading2",!1)},getShapProjectionResult:async({commit:e,state:t},a)=>{e("changeTargetModel",a),e("changeProjectionloading1",!0);const s=await rr(t.dataset,a);e("updateShapProjection",await s.data),e("changeProjectionloading1",!1)},getSubsetInfo:async({commit:e,state:t,getters:a})=>{const s=await(l=t.dataset,r=t.selectedmodels,n=a.selecteddataid,pe.all([er(l,n),tr(l,r,n),ar(l,r,n)]));var l,r,n;e("updateSubsetFeatureInfo",await s[0].data),e("updateSubsetShap",await s[1].data),e("updateSubsetStatistics",await s[2].data)},changeEncodeFeature:async({commit:e,state:t},a)=>{if(t.encodingfeature.name!==a){e("updateEncodingFeatureValue",(await((e,t)=>Ql.get(`/${e}/featurevalue/${t}`))(t.dataset,a)).data)}}});var or=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",setFeatures:(e,t)=>{e.features=t},setDatasetList:(e,t)=>{e.datasetlist=t},changeDataset:(e,t)=>{e.dataset=t},updateFeatureInfo:(e,t)=>{e.datainfo=t.datainfo,e.encodingfeature=t.datainfo.classfeature,e.classes=t.classes,e.featureinfo=t.featureinfo.filter((e=>"class"!==e.ftype)),e.classfeatureinfo=t.featureinfo.find((e=>"class"===e.ftype)).data,e.featurenames=t.featureinfo.map((e=>e.feature)),e.colorscale.domain(t.classes),e.colorscaledark.domain(t.classes)},updateSelectedFeatures:(e,t)=>{e.selectedfeatures=t},updateProjection:(e,t)=>{e.projectionresults=t},changeProjectionloading1:(e,t)=>{e.shapprojectionloading=t},changeProjectionloading2:(e,t)=>{e.projectionloading=t},changeDistributionloading:(e,t)=>{e.distributionloading=t},changeShapviewloading:(e,t)=>{e.shapviewloading=t},updateSelectedData:(e,t)=>{"new"===e.selectionmode?e.selecteddata=t:"union"===e.selectionmode?e.selecteddata=[...new Set([...e.selecteddata,...t])]:"intersection"===e.selectionmode&&(e.selecteddata=e.selecteddata.filter((e=>t.includes(e))))},updateSubsetFeatureInfo:(e,t)=>{e.subsetfeatureinfo=t.filter((e=>"class"!==e.ftype)),0===t.length?e.subsetclassfeature=[]:e.subsetclassfeature=t.find((e=>"class"===e.ftype)).data},changePredictionloading:(e,t)=>{e.predictionloading=t},changeidmap:(e,t)=>{e.idmap=t},updatemodelnames:(e,t)=>{e.models=t},initialmodelnames:(e,t)=>{e.selectedmodels=t,e.sortedmodelnames=["label"].concat(t)},updateselectedmodelnames:(e,t)=>{e.selectedmodels=t},updatesortedmodelnames:(e,t)=>{e.sortedmodelnames=t},updateModelInfos:(e,t)=>{e.selectedmodels.sort(((t,a)=>e.models.indexOf(t)-e.models.indexOf(a))),e.sortedmodelnames=["label"].concat(e.selectedmodels),e.predictions=t.predictions,e.featureuse=t.featureuse,e.shapvalues=t.shapvalues,e.subsetshap=t.shapvalues,e.statistics=t.statistics},updateSubsetShap:(e,t)=>{e.subsetshap=t},updateSubsetStatistics:(e,t)=>{e.subsetstatistics=t.statistics},changeSelectionFocus:(e,t)=>{e.selectionfocus=t},updatemodelmetrics:(e,t)=>{e.modelinfos=t},changeProjectionMethod:(e,t)=>{e.projectionmethod=t},updateEncodingFeatureValue:(e,t)=>{e.encodingfeature=t},changeselectionmode:(e,t)=>{e.selectionmode=t},updateShapProjection:(e,t)=>{e.shapprojection=t},changeTargetModel:(e,t)=>{e.targetmodel=t}});var ir=new ge({state:{predictions:[],datasetlist:[],dataset:"penguin",datainfo:{},classes:[],models:[],modelinfos:[],selectedmodels:[],sortedmodelnames:[],selecteddata:[],featurenames:[],featureinfo:[],classfeatureinfo:[],subsetfeatureinfo:[],subsetclassfeature:[],distributionloading:!1,selectionmode:"new",selectedfeatures:[],colorscale:he().range(["#fb8072","#80b1d3","#fdb462","#8dd3c7","#ffffb3","#bebada","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]),colorscaledark:he().range(["#FB4626","#2A8DD3","#FD9019","#35D3B3","#FFFF4D","#624CDA","#8EDE16","#FC58A5","#D98282","#BD39BD","#5DEB52","#FFE926"]),projectionresults:{},shapprojection:{},projectionloading:!1,shapprojectionloading:!1,selectionfocus:"models",predictionloading:!1,idmap:[],shapviewloading:!0,featureuse:[],shapvalues:[],subsetshap:[],statistics:[],subsetstatistics:[],projectionmethod:"tsne_all",encodingfeature:{},targetmodel:""},getters:Jl,mutations:or,actions:nr});const cr=ve(Kl);cr.config.productionTip=!1,cr.use(ir).use(ye).use(be).use(we).use(xe).use(ke).use(Se).use(Me).use(_e).use(je).use(Be).use(Fe).use(Ae).use(Pe),cr.mount("#app");
